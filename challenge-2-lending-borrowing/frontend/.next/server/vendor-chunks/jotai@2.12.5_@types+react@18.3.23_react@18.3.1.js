"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/jotai@2.12.5_@types+react@18.3.23_react@18.3.1";
exports.ids = ["vendor-chunks/jotai@2.12.5_@types+react@18.3.23_react@18.3.1"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/react.mjs":
/*!************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/react.mjs ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Provider: () => (/* binding */ Provider),\n/* harmony export */   useAtom: () => (/* binding */ useAtom),\n/* harmony export */   useAtomValue: () => (/* binding */ useAtomValue),\n/* harmony export */   useSetAtom: () => (/* binding */ useSetAtom),\n/* harmony export */   useStore: () => (/* binding */ useStore)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@14.2.30_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var jotai_vanilla__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jotai/vanilla */ \"(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla.mjs\");\n/* harmony import */ var jotai_vanilla_internals__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jotai/vanilla/internals */ \"(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/internals.mjs\");\n/* __next_internal_client_entry_do_not_use__ Provider,useAtom,useAtomValue,useSetAtom,useStore auto */ \n\n\nconst StoreContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(void 0);\nfunction useStore(options) {\n    const store = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(StoreContext);\n    return (options == null ? void 0 : options.store) || store || (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_1__.getDefaultStore)();\n}\nfunction Provider({ children, store }) {\n    const storeRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(void 0);\n    if (!store && !storeRef.current) {\n        storeRef.current = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_1__.createStore)();\n    }\n    return /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(StoreContext.Provider, {\n        value: store || storeRef.current\n    }, children);\n}\nconst isPromiseLike = (x)=>typeof (x == null ? void 0 : x.then) === \"function\";\nconst attachPromiseStatus = (promise)=>{\n    if (!promise.status) {\n        promise.status = \"pending\";\n        promise.then((v)=>{\n            promise.status = \"fulfilled\";\n            promise.value = v;\n        }, (e)=>{\n            promise.status = \"rejected\";\n            promise.reason = e;\n        });\n    }\n};\nconst use = react__WEBPACK_IMPORTED_MODULE_0__.use || // A shim for older React versions\n((promise)=>{\n    if (promise.status === \"pending\") {\n        throw promise;\n    } else if (promise.status === \"fulfilled\") {\n        return promise.value;\n    } else if (promise.status === \"rejected\") {\n        throw promise.reason;\n    } else {\n        attachPromiseStatus(promise);\n        throw promise;\n    }\n});\nconst continuablePromiseMap = /* @__PURE__ */ new WeakMap();\nconst createContinuablePromise = (promise, getValue)=>{\n    let continuablePromise = continuablePromiseMap.get(promise);\n    if (!continuablePromise) {\n        continuablePromise = new Promise((resolve, reject)=>{\n            let curr = promise;\n            const onFulfilled = (me)=>(v)=>{\n                    if (curr === me) {\n                        resolve(v);\n                    }\n                };\n            const onRejected = (me)=>(e)=>{\n                    if (curr === me) {\n                        reject(e);\n                    }\n                };\n            const onAbort = ()=>{\n                try {\n                    const nextValue = getValue();\n                    if (isPromiseLike(nextValue)) {\n                        continuablePromiseMap.set(nextValue, continuablePromise);\n                        curr = nextValue;\n                        nextValue.then(onFulfilled(nextValue), onRejected(nextValue));\n                        (0,jotai_vanilla_internals__WEBPACK_IMPORTED_MODULE_2__.INTERNAL_registerAbortHandler)(nextValue, onAbort);\n                    } else {\n                        resolve(nextValue);\n                    }\n                } catch (e) {\n                    reject(e);\n                }\n            };\n            promise.then(onFulfilled(promise), onRejected(promise));\n            (0,jotai_vanilla_internals__WEBPACK_IMPORTED_MODULE_2__.INTERNAL_registerAbortHandler)(promise, onAbort);\n        });\n        continuablePromiseMap.set(promise, continuablePromise);\n    }\n    return continuablePromise;\n};\nfunction useAtomValue(atom, options) {\n    const { delay, unstable_promiseStatus: promiseStatus = !react__WEBPACK_IMPORTED_MODULE_0__.use } = options || {};\n    const store = useStore(options);\n    const [[valueFromReducer, storeFromReducer, atomFromReducer], rerender] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useReducer)((prev)=>{\n        const nextValue = store.get(atom);\n        if (Object.is(prev[0], nextValue) && prev[1] === store && prev[2] === atom) {\n            return prev;\n        }\n        return [\n            nextValue,\n            store,\n            atom\n        ];\n    }, void 0, ()=>[\n            store.get(atom),\n            store,\n            atom\n        ]);\n    let value = valueFromReducer;\n    if (storeFromReducer !== store || atomFromReducer !== atom) {\n        rerender();\n        value = store.get(atom);\n    }\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        const unsub = store.sub(atom, ()=>{\n            if (promiseStatus) {\n                try {\n                    const value2 = store.get(atom);\n                    if (isPromiseLike(value2)) {\n                        attachPromiseStatus(createContinuablePromise(value2, ()=>store.get(atom)));\n                    }\n                } catch (e) {}\n            }\n            if (typeof delay === \"number\") {\n                setTimeout(rerender, delay);\n                return;\n            }\n            rerender();\n        });\n        rerender();\n        return unsub;\n    }, [\n        store,\n        atom,\n        delay,\n        promiseStatus\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useDebugValue)(value);\n    if (isPromiseLike(value)) {\n        const promise = createContinuablePromise(value, ()=>store.get(atom));\n        if (promiseStatus) {\n            attachPromiseStatus(promise);\n        }\n        return use(promise);\n    }\n    return value;\n}\nfunction useSetAtom(atom, options) {\n    const store = useStore(options);\n    const setAtom = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((...args)=>{\n        if (( false ? 0 : void 0) !== \"production\" && !(\"write\" in atom)) {\n            throw new Error(\"not writable atom\");\n        }\n        return store.set(atom, ...args);\n    }, [\n        store,\n        atom\n    ]);\n    return setAtom;\n}\nfunction useAtom(atom, options) {\n    return [\n        useAtomValue(atom, options),\n        // We do wrong type assertion here, which results in throwing an error.\n        useSetAtom(atom, options)\n    ];\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vam90YWlAMi4xMi41X0B0eXBlcytyZWFjdEAxOC4zLjIzX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvam90YWkvZXNtL3JlYWN0Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozt1R0FDbUk7QUFDdEU7QUFDVztBQUV4RSxNQUFNWSw2QkFBZVgsb0RBQWFBLENBQ2hDLEtBQUs7QUFFUCxTQUFTWSxTQUFTQyxPQUFPO0lBQ3ZCLE1BQU1DLFFBQVFiLGlEQUFVQSxDQUFDVTtJQUN6QixPQUFPLENBQUNFLFdBQVcsT0FBTyxLQUFLLElBQUlBLFFBQVFDLEtBQUssS0FBS0EsU0FBU04sOERBQWVBO0FBQy9FO0FBQ0EsU0FBU08sU0FBUyxFQUNoQkMsUUFBUSxFQUNSRixLQUFLLEVBQ047SUFDQyxNQUFNRyxXQUFXZiw2Q0FBTUEsQ0FBQyxLQUFLO0lBQzdCLElBQUksQ0FBQ1ksU0FBUyxDQUFDRyxTQUFTQyxPQUFPLEVBQUU7UUFDL0JELFNBQVNDLE9BQU8sR0FBR1QsMERBQVdBO0lBQ2hDO0lBQ0EscUJBQU9OLG9EQUFhQSxDQUNsQlEsYUFBYUksUUFBUSxFQUNyQjtRQUNFSSxPQUFPTCxTQUFTRyxTQUFTQyxPQUFPO0lBQ2xDLEdBQ0FGO0FBRUo7QUFFQSxNQUFNSSxnQkFBZ0IsQ0FBQ0MsSUFBTSxPQUFRQSxDQUFBQSxLQUFLLE9BQU8sS0FBSyxJQUFJQSxFQUFFQyxJQUFJLE1BQU07QUFDdEUsTUFBTUMsc0JBQXNCLENBQUNDO0lBQzNCLElBQUksQ0FBQ0EsUUFBUUMsTUFBTSxFQUFFO1FBQ25CRCxRQUFRQyxNQUFNLEdBQUc7UUFDakJELFFBQVFGLElBQUksQ0FDVixDQUFDSTtZQUNDRixRQUFRQyxNQUFNLEdBQUc7WUFDakJELFFBQVFMLEtBQUssR0FBR087UUFDbEIsR0FDQSxDQUFDQztZQUNDSCxRQUFRQyxNQUFNLEdBQUc7WUFDakJELFFBQVFJLE1BQU0sR0FBR0Q7UUFDbkI7SUFFSjtBQUNGO0FBQ0Es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QUcsQ0FBQ1k7b0JBRXJEO2dCQUNGLEVBQUUsT0FBT3BCLEdBQUcsQ0FDWjtZQUNGO1lBQ0EsSUFBSSxPQUFPcUIsVUFBVSxVQUFVO2dCQUM3QmEsV0FBV1AsVUFBVU47Z0JBQ3JCO1lBQ0Y7WUFDQU07UUFDRjtRQUNBQTtRQUNBLE9BQU9JO0lBQ1QsR0FBRztRQUFDNUM7UUFBT2lDO1FBQU1DO1FBQU9FO0tBQWM7SUFDdEM1QyxvREFBYUEsQ0FBQ2E7SUFDZCxJQUFJQyxjQUFjRCxRQUFRO1FBQ3hCLE1BQU1LLFVBQVVRLHlCQUF5QmIsT0FBTyxJQUFNTCxNQUFNcUIsR0FBRyxDQUFDWTtRQUNoRSxJQUFJRyxlQUFlO1lBQ2pCM0Isb0JBQW9CQztRQUN0QjtRQUNBLE9BQU9LLElBQUlMO0lBQ2I7SUFDQSxPQUFPTDtBQUNUO0FBRUEsU0FBUzJDLFdBQVdmLElBQUksRUFBRWxDLE9BQU87SUFDL0IsTUFBTUMsUUFBUUYsU0FBU0M7SUFDdkIsTUFBTWtELFVBQVV4RCxrREFBV0EsQ0FDekIsQ0FBQyxHQUFHeUQ7UUFDRixJQUFJLENBQUMsTUFBZSxHQUFHLENBQW9CLEdBQUcsS0FBSyxPQUFPLGdCQUFnQixDQUFFLFlBQVdqQixJQUFHLEdBQUk7WUFDNUYsTUFBTSxJQUFJb0IsTUFBTTtRQUNsQjtRQUNBLE9BQU9yRCxNQUFNK0IsR0FBRyxDQUFDRSxTQUFTaUI7SUFDNUIsR0FDQTtRQUFDbEQ7UUFBT2lDO0tBQUs7SUFFZixPQUFPZ0I7QUFDVDtBQUVBLFNBQVNLLFFBQVFyQixJQUFJLEVBQUVsQyxPQUFPO0lBQzVCLE9BQU87UUFDTGlDLGFBQWFDLE1BQU1sQztRQUNuQix1RUFBdUU7UUFDdkVpRCxXQUFXZixNQUFNbEM7S0FDbEI7QUFDSDtBQUVpRSIsInNvdXJjZXMiOlsid2VicGFjazovL2RvdHVpLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2pvdGFpQDIuMTIuNV9AdHlwZXMrcmVhY3RAMTguMy4yM19yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL2pvdGFpL2VzbS9yZWFjdC5tanM/ODk2OSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCc7XG5pbXBvcnQgUmVhY3QsIHsgY3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlUmVmLCBjcmVhdGVFbGVtZW50LCB1c2VSZWR1Y2VyLCB1c2VFZmZlY3QsIHVzZURlYnVnVmFsdWUsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgZ2V0RGVmYXVsdFN0b3JlLCBjcmVhdGVTdG9yZSB9IGZyb20gJ2pvdGFpL3ZhbmlsbGEnO1xuaW1wb3J0IHsgSU5URVJOQUxfcmVnaXN0ZXJBYm9ydEhhbmRsZXIgfSBmcm9tICdqb3RhaS92YW5pbGxhL2ludGVybmFscyc7XG5cbmNvbnN0IFN0b3JlQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQoXG4gIHZvaWQgMFxuKTtcbmZ1bmN0aW9uIHVzZVN0b3JlKG9wdGlvbnMpIHtcbiAgY29uc3Qgc3RvcmUgPSB1c2VDb250ZXh0KFN0b3JlQ29udGV4dCk7XG4gIHJldHVybiAob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5zdG9yZSkgfHwgc3RvcmUgfHwgZ2V0RGVmYXVsdFN0b3JlKCk7XG59XG5mdW5jdGlvbiBQcm92aWRlcih7XG4gIGNoaWxkcmVuLFxuICBzdG9yZVxufSkge1xuICBjb25zdCBzdG9yZVJlZiA9IHVzZVJlZih2b2lkIDApO1xuICBpZiAoIXN0b3JlICYmICFzdG9yZVJlZi5jdXJyZW50KSB7XG4gICAgc3RvcmVSZWYuY3VycmVudCA9IGNyZWF0ZVN0b3JlKCk7XG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQoXG4gICAgU3RvcmVDb250ZXh0LlByb3ZpZGVyLFxuICAgIHtcbiAgICAgIHZhbHVlOiBzdG9yZSB8fCBzdG9yZVJlZi5jdXJyZW50XG4gICAgfSxcbiAgICBjaGlsZHJlblxuICApO1xufVxuXG5jb25zdCBpc1Byb21pc2VMaWtlID0gKHgpID0+IHR5cGVvZiAoeCA9PSBudWxsID8gdm9pZCAwIDogeC50aGVuKSA9PT0gXCJmdW5jdGlvblwiO1xuY29uc3QgYXR0YWNoUHJvbWlzZVN0YXR1cyA9IChwcm9taXNlKSA9PiB7XG4gIGlmICghcHJvbWlzZS5zdGF0dXMpIHtcbiAgICBwcm9taXNlLnN0YXR1cyA9IFwicGVuZGluZ1wiO1xuICAgIHByb21pc2UudGhlbihcbiAgICAgICh2KSA9PiB7XG4gICAgICAgIHByb21pc2Uuc3RhdHVzID0gXCJmdWxmaWxsZWRcIjtcbiAgICAgICAgcHJvbWlzZS52YWx1ZSA9IHY7XG4gICAgICB9LFxuICAgICAgKGUpID0+IHtcbiAgICAgICAgcHJvbWlzZS5zdGF0dXMgPSBcInJlamVjdGVkXCI7XG4gICAgICAgIHByb21pc2UucmVhc29uID0gZTtcbiAgICAgIH1cbiAgICApO1xuICB9XG59O1xuY29uc3QgdXNlID0gUmVhY3QudXNlIHx8IC8vIEEgc2hpbSBmb3Igb2xkZXIgUmVhY3QgdmVyc2lvbnNcbigocHJvbWlzZSkgPT4ge1xuICBpZiAocHJvbWlzZS5zdGF0dXMgPT09IFwicGVuZGluZ1wiKSB7XG4gICAgdGhyb3cgcHJvbWlzZTtcbiAgfSBlbHNlIGlmIChwcm9taXNlLnN0YXR1cyA9PT0gXCJmdWxmaWxsZWRcIikge1xuICAgIHJldHVybiBwcm9taXNlLnZhbHVlO1xuICB9IGVsc2UgaWYgKHByb21pc2Uuc3RhdHVzID09PSBcInJlamVjdGVkXCIpIHtcbiAgICB0aHJvdyBwcm9taXNlLnJlYXNvbjtcbiAgfSBlbHNlIHtcbiAgICBhdHRhY2hQcm9taXNlU3RhdHVzKHByb21pc2UpO1xuICAgIHRocm93IHByb21pc2U7XG4gIH1cbn0pO1xuY29uc3QgY29udGludWFibGVQcm9taXNlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG5jb25zdCBjcmVhdGVDb250aW51YWJsZVByb21pc2UgPSAocHJvbWlzZSwgZ2V0VmFsdWUpID0+IHtcbiAgbGV0IGNvbnRpbnVhYmxlUHJvbWlzZSA9IGNvbnRpbnVhYmxlUHJvbWlzZU1hcC5nZXQocHJvbWlzZSk7XG4gIGlmICghY29udGludWFibGVQcm9taXNlKSB7XG4gICAgY29udGludWFibGVQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbGV0IGN1cnIgPSBwcm9taXNlO1xuICAgICAgY29uc3Qgb25GdWxmaWxsZWQgPSAobWUpID0+ICh2KSA9PiB7XG4gICAgICAgIGlmIChjdXJyID09PSBtZSkge1xuICAgICAgICAgIHJlc29sdmUodik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBjb25zdCBvblJlamVjdGVkID0gKG1lKSA9PiAoZSkgPT4ge1xuICAgICAgICBpZiAoY3VyciA9PT0gbWUpIHtcbiAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBjb25zdCBvbkFib3J0ID0gKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IG5leHRWYWx1ZSA9IGdldFZhbHVlKCk7XG4gICAgICAgICAgaWYgKGlzUHJvbWlzZUxpa2UobmV4dFZhbHVlKSkge1xuICAgICAgICAgICAgY29udGludWFibGVQcm9taXNlTWFwLnNldChuZXh0VmFsdWUsIGNvbnRpbnVhYmxlUHJvbWlzZSk7XG4gICAgICAgICAgICBjdXJyID0gbmV4dFZhbHVlO1xuICAgICAgICAgICAgbmV4dFZhbHVlLnRoZW4ob25GdWxmaWxsZWQobmV4dFZhbHVlKSwgb25SZWplY3RlZChuZXh0VmFsdWUpKTtcbiAgICAgICAgICAgIElOVEVSTkFMX3JlZ2lzdGVyQWJvcnRIYW5kbGVyKG5leHRWYWx1ZSwgb25BYm9ydCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmUobmV4dFZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBwcm9taXNlLnRoZW4ob25GdWxmaWxsZWQocHJvbWlzZSksIG9uUmVqZWN0ZWQocHJvbWlzZSkpO1xuICAgICAgSU5URVJOQUxfcmVnaXN0ZXJBYm9ydEhhbmRsZXIocHJvbWlzZSwgb25BYm9ydCk7XG4gICAgfSk7XG4gICAgY29udGludWFibGVQcm9taXNlTWFwLnNldChwcm9taXNlLCBjb250aW51YWJsZVByb21pc2UpO1xuICB9XG4gIHJldHVybiBjb250aW51YWJsZVByb21pc2U7XG59O1xuZnVuY3Rpb24gdXNlQXRvbVZhbHVlKGF0b20sIG9wdGlvbnMpIHtcbiAgY29uc3QgeyBkZWxheSwgdW5zdGFibGVfcHJvbWlzZVN0YXR1czogcHJvbWlzZVN0YXR1cyA9ICFSZWFjdC51c2UgfSA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUob3B0aW9ucyk7XG4gIGNvbnN0IFtbdmFsdWVGcm9tUmVkdWNlciwgc3RvcmVGcm9tUmVkdWNlciwgYXRvbUZyb21SZWR1Y2VyXSwgcmVyZW5kZXJdID0gdXNlUmVkdWNlcihcbiAgICAocHJldikgPT4ge1xuICAgICAgY29uc3QgbmV4dFZhbHVlID0gc3RvcmUuZ2V0KGF0b20pO1xuICAgICAgaWYgKE9iamVjdC5pcyhwcmV2WzBdLCBuZXh0VmFsdWUpICYmIHByZXZbMV0gPT09IHN0b3JlICYmIHByZXZbMl0gPT09IGF0b20pIHtcbiAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICB9XG4gICAgICByZXR1cm4gW25leHRWYWx1ZSwgc3RvcmUsIGF0b21dO1xuICAgIH0sXG4gICAgdm9pZCAwLFxuICAgICgpID0+IFtzdG9yZS5nZXQoYXRvbSksIHN0b3JlLCBhdG9tXVxuICApO1xuICBsZXQgdmFsdWUgPSB2YWx1ZUZyb21SZWR1Y2VyO1xuICBpZiAoc3RvcmVGcm9tUmVkdWNlciAhPT0gc3RvcmUgfHwgYXRvbUZyb21SZWR1Y2VyICE9PSBhdG9tKSB7XG4gICAgcmVyZW5kZXIoKTtcbiAgICB2YWx1ZSA9IHN0b3JlLmdldChhdG9tKTtcbiAgfVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHVuc3ViID0gc3RvcmUuc3ViKGF0b20sICgpID0+IHtcbiAgICAgIGlmIChwcm9taXNlU3RhdHVzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgdmFsdWUyID0gc3RvcmUuZ2V0KGF0b20pO1xuICAgICAgICAgIGlmIChpc1Byb21pc2VMaWtlKHZhbHVlMikpIHtcbiAgICAgICAgICAgIGF0dGFjaFByb21pc2VTdGF0dXMoXG4gICAgICAgICAgICAgIGNyZWF0ZUNvbnRpbnVhYmxlUHJvbWlzZSh2YWx1ZTIsICgpID0+IHN0b3JlLmdldChhdG9tKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgZGVsYXkgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgc2V0VGltZW91dChyZXJlbmRlciwgZGVsYXkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICByZXJlbmRlcigpO1xuICAgIH0pO1xuICAgIHJlcmVuZGVyKCk7XG4gICAgcmV0dXJuIHVuc3ViO1xuICB9LCBbc3RvcmUsIGF0b20sIGRlbGF5LCBwcm9taXNlU3RhdHVzXSk7XG4gIHVzZURlYnVnVmFsdWUodmFsdWUpO1xuICBpZiAoaXNQcm9taXNlTGlrZSh2YWx1ZSkpIHtcbiAgICBjb25zdCBwcm9taXNlID0gY3JlYXRlQ29udGludWFibGVQcm9taXNlKHZhbHVlLCAoKSA9PiBzdG9yZS5nZXQoYXRvbSkpO1xuICAgIGlmIChwcm9taXNlU3RhdHVzKSB7XG4gICAgICBhdHRhY2hQcm9taXNlU3RhdHVzKHByb21pc2UpO1xuICAgIH1cbiAgICByZXR1cm4gdXNlKHByb21pc2UpO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZnVuY3Rpb24gdXNlU2V0QXRvbShhdG9tLCBvcHRpb25zKSB7XG4gIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUob3B0aW9ucyk7XG4gIGNvbnN0IHNldEF0b20gPSB1c2VDYWxsYmFjayhcbiAgICAoLi4uYXJncykgPT4ge1xuICAgICAgaWYgKChpbXBvcnQubWV0YS5lbnYgPyBpbXBvcnQubWV0YS5lbnYuTU9ERSA6IHZvaWQgMCkgIT09IFwicHJvZHVjdGlvblwiICYmICEoXCJ3cml0ZVwiIGluIGF0b20pKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIm5vdCB3cml0YWJsZSBhdG9tXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN0b3JlLnNldChhdG9tLCAuLi5hcmdzKTtcbiAgICB9LFxuICAgIFtzdG9yZSwgYXRvbV1cbiAgKTtcbiAgcmV0dXJuIHNldEF0b207XG59XG5cbmZ1bmN0aW9uIHVzZUF0b20oYXRvbSwgb3B0aW9ucykge1xuICByZXR1cm4gW1xuICAgIHVzZUF0b21WYWx1ZShhdG9tLCBvcHRpb25zKSxcbiAgICAvLyBXZSBkbyB3cm9uZyB0eXBlIGFzc2VydGlvbiBoZXJlLCB3aGljaCByZXN1bHRzIGluIHRocm93aW5nIGFuIGVycm9yLlxuICAgIHVzZVNldEF0b20oYXRvbSwgb3B0aW9ucylcbiAgXTtcbn1cblxuZXhwb3J0IHsgUHJvdmlkZXIsIHVzZUF0b20sIHVzZUF0b21WYWx1ZSwgdXNlU2V0QXRvbSwgdXNlU3RvcmUgfTtcbiJdLCJuYW1lcyI6WyJSZWFjdCIsImNyZWF0ZUNvbnRleHQiLCJ1c2VDb250ZXh0IiwidXNlUmVmIiwiY3JlYXRlRWxlbWVudCIsInVzZVJlZHVjZXIiLCJ1c2VFZmZlY3QiLCJ1c2VEZWJ1Z1ZhbHVlIiwidXNlQ2FsbGJhY2siLCJnZXREZWZhdWx0U3RvcmUiLCJjcmVhdGVTdG9yZSIsIklOVEVSTkFMX3JlZ2lzdGVyQWJvcnRIYW5kbGVyIiwiU3RvcmVDb250ZXh0IiwidXNlU3RvcmUiLCJvcHRpb25zIiwic3RvcmUiLCJQcm92aWRlciIsImNoaWxkcmVuIiwic3RvcmVSZWYiLCJjdXJyZW50IiwidmFsdWUiLCJpc1Byb21pc2VMaWtlIiwieCIsInRoZW4iLCJhdHRhY2hQcm9taXNlU3RhdHVzIiwicHJvbWlzZSIsInN0YXR1cyIsInYiLCJlIiwicmVhc29uIiwidXNlIiwiY29udGludWFibGVQcm9taXNlTWFwIiwiV2Vha01hcCIsImNyZWF0ZUNvbnRpbnVhYmxlUHJvbWlzZSIsImdldFZhbHVlIiwiY29udGludWFibGVQcm9taXNlIiwiZ2V0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjdXJyIiwib25GdWxmaWxsZWQiLCJtZSIsIm9uUmVqZWN0ZWQiLCJvbkFib3J0IiwibmV4dFZhbHVlIiwic2V0IiwidXNlQXRvbVZhbHVlIiwiYXRvbSIsImRlbGF5IiwidW5zdGFibGVfcHJvbWlzZVN0YXR1cyIsInByb21pc2VTdGF0dXMiLCJ2YWx1ZUZyb21SZWR1Y2VyIiwic3RvcmVGcm9tUmVkdWNlciIsImF0b21Gcm9tUmVkdWNlciIsInJlcmVuZGVyIiwicHJldiIsIk9iamVjdCIsImlzIiwidW5zdWIiLCJzdWIiLCJ2YWx1ZTIiLCJzZXRUaW1lb3V0IiwidXNlU2V0QXRvbSIsInNldEF0b20iLCJhcmdzIiwiZW52IiwiTU9ERSIsIkVycm9yIiwidXNlQXRvbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/react.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla.mjs":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla.mjs ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   INTERNAL_overrideCreateStore: () => (/* binding */ INTERNAL_overrideCreateStore),\n/* harmony export */   atom: () => (/* binding */ atom),\n/* harmony export */   createStore: () => (/* binding */ createStore),\n/* harmony export */   getDefaultStore: () => (/* binding */ getDefaultStore)\n/* harmony export */ });\n/* harmony import */ var jotai_vanilla_internals__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jotai/vanilla/internals */ \"(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/internals.mjs\");\n\n\nlet keyCount = 0;\nfunction atom(read, write) {\n  const key = `atom${++keyCount}`;\n  const config = {\n    toString() {\n      return ( false ? 0 : void 0) !== \"production\" && this.debugLabel ? key + \":\" + this.debugLabel : key;\n    }\n  };\n  if (typeof read === \"function\") {\n    config.read = read;\n  } else {\n    config.init = read;\n    config.read = defaultRead;\n    config.write = defaultWrite;\n  }\n  if (write) {\n    config.write = write;\n  }\n  return config;\n}\nfunction defaultRead(get) {\n  return get(this);\n}\nfunction defaultWrite(get, set, arg) {\n  return set(\n    this,\n    typeof arg === \"function\" ? arg(get(this)) : arg\n  );\n}\n\nconst createDevStoreRev4 = () => {\n  let inRestoreAtom = 0;\n  const storeHooks = (0,jotai_vanilla_internals__WEBPACK_IMPORTED_MODULE_0__.INTERNAL_initializeStoreHooks)({});\n  const atomStateMap = /* @__PURE__ */ new WeakMap();\n  const mountedAtoms = /* @__PURE__ */ new WeakMap();\n  const store = (0,jotai_vanilla_internals__WEBPACK_IMPORTED_MODULE_0__.INTERNAL_buildStoreRev1)(\n    atomStateMap,\n    mountedAtoms,\n    void 0,\n    void 0,\n    void 0,\n    void 0,\n    storeHooks,\n    void 0,\n    (atom, get, set, ...args) => {\n      if (inRestoreAtom) {\n        return set(atom, ...args);\n      }\n      return atom.write(get, set, ...args);\n    }\n  );\n  const debugMountedAtoms = /* @__PURE__ */ new Set();\n  storeHooks.m.add(void 0, (atom) => {\n    debugMountedAtoms.add(atom);\n    const atomState = atomStateMap.get(atom);\n    atomState.m = mountedAtoms.get(atom);\n  });\n  storeHooks.u.add(void 0, (atom) => {\n    debugMountedAtoms.delete(atom);\n    const atomState = atomStateMap.get(atom);\n    delete atomState.m;\n  });\n  const devStore = {\n    // store dev methods (these are tentative and subject to change without notice)\n    dev4_get_internal_weak_map: () => {\n      console.log(\"Deprecated: Use devstore from the devtools library\");\n      return atomStateMap;\n    },\n    dev4_get_mounted_atoms: () => debugMountedAtoms,\n    dev4_restore_atoms: (values) => {\n      const restoreAtom = {\n        read: () => null,\n        write: (_get, set) => {\n          ++inRestoreAtom;\n          try {\n            for (const [atom, value] of values) {\n              if (\"init\" in atom) {\n                set(atom, value);\n              }\n            }\n          } finally {\n            --inRestoreAtom;\n          }\n        }\n      };\n      store.set(restoreAtom);\n    }\n  };\n  return Object.assign(store, devStore);\n};\nlet overiddenCreateStore;\nfunction INTERNAL_overrideCreateStore(fn) {\n  overiddenCreateStore = fn(overiddenCreateStore);\n}\nfunction createStore() {\n  if (overiddenCreateStore) {\n    return overiddenCreateStore();\n  }\n  if (( false ? 0 : void 0) !== \"production\") {\n    return createDevStoreRev4();\n  }\n  return (0,jotai_vanilla_internals__WEBPACK_IMPORTED_MODULE_0__.INTERNAL_buildStoreRev1)();\n}\nlet defaultStore;\nfunction getDefaultStore() {\n  if (!defaultStore) {\n    defaultStore = createStore();\n    if (( false ? 0 : void 0) !== \"production\") {\n      globalThis.__JOTAI_DEFAULT_STORE__ || (globalThis.__JOTAI_DEFAULT_STORE__ = defaultStore);\n      if (globalThis.__JOTAI_DEFAULT_STORE__ !== defaultStore) {\n        console.warn(\n          \"Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044\"\n        );\n      }\n    }\n  }\n  return defaultStore;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vam90YWlAMi4xMi41X0B0eXBlcytyZWFjdEAxOC4zLjIzX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvam90YWkvZXNtL3ZhbmlsbGEubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQWlHOztBQUVqRztBQUNBO0FBQ0EscUJBQXFCLFdBQVc7QUFDaEM7QUFDQTtBQUNBLGNBQWMsTUFBZSxHQUFHLENBQW9CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EscUJBQXFCLHNGQUE2QixHQUFHO0FBQ3JEO0FBQ0E7QUFDQSxnQkFBZ0IsZ0ZBQXVCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sTUFBZSxHQUFHLENBQW9CO0FBQzdDO0FBQ0E7QUFDQSxTQUFTLGdGQUF1QjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxNQUFlLEdBQUcsQ0FBb0I7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRTRFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZG90dWkvLi9ub2RlX21vZHVsZXMvLnBucG0vam90YWlAMi4xMi41X0B0eXBlcytyZWFjdEAxOC4zLjIzX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvam90YWkvZXNtL3ZhbmlsbGEubWpzP2I2YjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSU5URVJOQUxfYnVpbGRTdG9yZVJldjEsIElOVEVSTkFMX2luaXRpYWxpemVTdG9yZUhvb2tzIH0gZnJvbSAnam90YWkvdmFuaWxsYS9pbnRlcm5hbHMnO1xuXG5sZXQga2V5Q291bnQgPSAwO1xuZnVuY3Rpb24gYXRvbShyZWFkLCB3cml0ZSkge1xuICBjb25zdCBrZXkgPSBgYXRvbSR7KytrZXlDb3VudH1gO1xuICBjb25zdCBjb25maWcgPSB7XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICByZXR1cm4gKGltcG9ydC5tZXRhLmVudiA/IGltcG9ydC5tZXRhLmVudi5NT0RFIDogdm9pZCAwKSAhPT0gXCJwcm9kdWN0aW9uXCIgJiYgdGhpcy5kZWJ1Z0xhYmVsID8ga2V5ICsgXCI6XCIgKyB0aGlzLmRlYnVnTGFiZWwgOiBrZXk7XG4gICAgfVxuICB9O1xuICBpZiAodHlwZW9mIHJlYWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgIGNvbmZpZy5yZWFkID0gcmVhZDtcbiAgfSBlbHNlIHtcbiAgICBjb25maWcuaW5pdCA9IHJlYWQ7XG4gICAgY29uZmlnLnJlYWQgPSBkZWZhdWx0UmVhZDtcbiAgICBjb25maWcud3JpdGUgPSBkZWZhdWx0V3JpdGU7XG4gIH1cbiAgaWYgKHdyaXRlKSB7XG4gICAgY29uZmlnLndyaXRlID0gd3JpdGU7XG4gIH1cbiAgcmV0dXJuIGNvbmZpZztcbn1cbmZ1bmN0aW9uIGRlZmF1bHRSZWFkKGdldCkge1xuICByZXR1cm4gZ2V0KHRoaXMpO1xufVxuZnVuY3Rpb24gZGVmYXVsdFdyaXRlKGdldCwgc2V0LCBhcmcpIHtcbiAgcmV0dXJuIHNldChcbiAgICB0aGlzLFxuICAgIHR5cGVvZiBhcmcgPT09IFwiZnVuY3Rpb25cIiA/IGFyZyhnZXQodGhpcykpIDogYXJnXG4gICk7XG59XG5cbmNvbnN0IGNyZWF0ZURldlN0b3JlUmV2NCA9ICgpID0+IHtcbiAgbGV0IGluUmVzdG9yZUF0b20gPSAwO1xuICBjb25zdCBzdG9yZUhvb2tzID0gSU5URVJOQUxfaW5pdGlhbGl6ZVN0b3JlSG9va3Moe30pO1xuICBjb25zdCBhdG9tU3RhdGVNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgY29uc3QgbW91bnRlZEF0b21zID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG4gIGNvbnN0IHN0b3JlID0gSU5URVJOQUxfYnVpbGRTdG9yZVJldjEoXG4gICAgYXRvbVN0YXRlTWFwLFxuICAgIG1vdW50ZWRBdG9tcyxcbiAgICB2b2lkIDAsXG4gICAgdm9pZCAwLFxuICAgIHZvaWQgMCxcbiAgICB2b2lkIDAsXG4gICAgc3RvcmVIb29rcyxcbiAgICB2b2lkIDAsXG4gICAgKGF0b20sIGdldCwgc2V0LCAuLi5hcmdzKSA9PiB7XG4gICAgICBpZiAoaW5SZXN0b3JlQXRvbSkge1xuICAgICAgICByZXR1cm4gc2V0KGF0b20sIC4uLmFyZ3MpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGF0b20ud3JpdGUoZ2V0LCBzZXQsIC4uLmFyZ3MpO1xuICAgIH1cbiAgKTtcbiAgY29uc3QgZGVidWdNb3VudGVkQXRvbXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBzdG9yZUhvb2tzLm0uYWRkKHZvaWQgMCwgKGF0b20pID0+IHtcbiAgICBkZWJ1Z01vdW50ZWRBdG9tcy5hZGQoYXRvbSk7XG4gICAgY29uc3QgYXRvbVN0YXRlID0gYXRvbVN0YXRlTWFwLmdldChhdG9tKTtcbiAgICBhdG9tU3RhdGUubSA9IG1vdW50ZWRBdG9tcy5nZXQoYXRvbSk7XG4gIH0pO1xuICBzdG9yZUhvb2tzLnUuYWRkKHZvaWQgMCwgKGF0b20pID0+IHtcbiAgICBkZWJ1Z01vdW50ZWRBdG9tcy5kZWxldGUoYXRvbSk7XG4gICAgY29uc3QgYXRvbVN0YXRlID0gYXRvbVN0YXRlTWFwLmdldChhdG9tKTtcbiAgICBkZWxldGUgYXRvbVN0YXRlLm07XG4gIH0pO1xuICBjb25zdCBkZXZTdG9yZSA9IHtcbiAgICAvLyBzdG9yZSBkZXYgbWV0aG9kcyAodGhlc2UgYXJlIHRlbnRhdGl2ZSBhbmQgc3ViamVjdCB0byBjaGFuZ2Ugd2l0aG91dCBub3RpY2UpXG4gICAgZGV2NF9nZXRfaW50ZXJuYWxfd2Vha19tYXA6ICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRGVwcmVjYXRlZDogVXNlIGRldnN0b3JlIGZyb20gdGhlIGRldnRvb2xzIGxpYnJhcnlcIik7XG4gICAgICByZXR1cm4gYXRvbVN0YXRlTWFwO1xuICAgIH0sXG4gICAgZGV2NF9nZXRfbW91bnRlZF9hdG9tczogKCkgPT4gZGVidWdNb3VudGVkQXRvbXMsXG4gICAgZGV2NF9yZXN0b3JlX2F0b21zOiAodmFsdWVzKSA9PiB7XG4gICAgICBjb25zdCByZXN0b3JlQXRvbSA9IHtcbiAgICAgICAgcmVhZDogKCkgPT4gbnVsbCxcbiAgICAgICAgd3JpdGU6IChfZ2V0LCBzZXQpID0+IHtcbiAgICAgICAgICArK2luUmVzdG9yZUF0b207XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2F0b20sIHZhbHVlXSBvZiB2YWx1ZXMpIHtcbiAgICAgICAgICAgICAgaWYgKFwiaW5pdFwiIGluIGF0b20pIHtcbiAgICAgICAgICAgICAgICBzZXQoYXRvbSwgdmFsdWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIC0taW5SZXN0b3JlQXRvbTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBzdG9yZS5zZXQocmVzdG9yZUF0b20pO1xuICAgIH1cbiAgfTtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oc3RvcmUsIGRldlN0b3JlKTtcbn07XG5sZXQgb3ZlcmlkZGVuQ3JlYXRlU3RvcmU7XG5mdW5jdGlvbiBJTlRFUk5BTF9vdmVycmlkZUNyZWF0ZVN0b3JlKGZuKSB7XG4gIG92ZXJpZGRlbkNyZWF0ZVN0b3JlID0gZm4ob3ZlcmlkZGVuQ3JlYXRlU3RvcmUpO1xufVxuZnVuY3Rpb24gY3JlYXRlU3RvcmUoKSB7XG4gIGlmIChvdmVyaWRkZW5DcmVhdGVTdG9yZSkge1xuICAgIHJldHVybiBvdmVyaWRkZW5DcmVhdGVTdG9yZSgpO1xuICB9XG4gIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIHJldHVybiBjcmVhdGVEZXZTdG9yZVJldjQoKTtcbiAgfVxuICByZXR1cm4gSU5URVJOQUxfYnVpbGRTdG9yZVJldjEoKTtcbn1cbmxldCBkZWZhdWx0U3RvcmU7XG5mdW5jdGlvbiBnZXREZWZhdWx0U3RvcmUoKSB7XG4gIGlmICghZGVmYXVsdFN0b3JlKSB7XG4gICAgZGVmYXVsdFN0b3JlID0gY3JlYXRlU3RvcmUoKTtcbiAgICBpZiAoKGltcG9ydC5tZXRhLmVudiA/IGltcG9ydC5tZXRhLmVudi5NT0RFIDogdm9pZCAwKSAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgIGdsb2JhbFRoaXMuX19KT1RBSV9ERUZBVUxUX1NUT1JFX18gfHwgKGdsb2JhbFRoaXMuX19KT1RBSV9ERUZBVUxUX1NUT1JFX18gPSBkZWZhdWx0U3RvcmUpO1xuICAgICAgaWYgKGdsb2JhbFRoaXMuX19KT1RBSV9ERUZBVUxUX1NUT1JFX18gIT09IGRlZmF1bHRTdG9yZSkge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJEZXRlY3RlZCBtdWx0aXBsZSBKb3RhaSBpbnN0YW5jZXMuIEl0IG1heSBjYXVzZSB1bmV4cGVjdGVkIGJlaGF2aW9yIHdpdGggdGhlIGRlZmF1bHQgc3RvcmUuIGh0dHBzOi8vZ2l0aHViLmNvbS9wbW5kcnMvam90YWkvZGlzY3Vzc2lvbnMvMjA0NFwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBkZWZhdWx0U3RvcmU7XG59XG5cbmV4cG9ydCB7IElOVEVSTkFMX292ZXJyaWRlQ3JlYXRlU3RvcmUsIGF0b20sIGNyZWF0ZVN0b3JlLCBnZXREZWZhdWx0U3RvcmUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/internals.mjs":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/internals.mjs ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   INTERNAL_abortPromise: () => (/* binding */ INTERNAL_abortPromise),\n/* harmony export */   INTERNAL_addPendingPromiseToDependency: () => (/* binding */ INTERNAL_addPendingPromiseToDependency),\n/* harmony export */   INTERNAL_buildStoreRev1: () => (/* binding */ INTERNAL_buildStoreRev1),\n/* harmony export */   INTERNAL_getBuildingBlocksRev1: () => (/* binding */ INTERNAL_getBuildingBlocksRev1),\n/* harmony export */   INTERNAL_getMountedOrPendingDependents: () => (/* binding */ INTERNAL_getMountedOrPendingDependents),\n/* harmony export */   INTERNAL_hasInitialValue: () => (/* binding */ INTERNAL_hasInitialValue),\n/* harmony export */   INTERNAL_initializeStoreHooks: () => (/* binding */ INTERNAL_initializeStoreHooks),\n/* harmony export */   INTERNAL_isActuallyWritableAtom: () => (/* binding */ INTERNAL_isActuallyWritableAtom),\n/* harmony export */   INTERNAL_isAtomStateInitialized: () => (/* binding */ INTERNAL_isAtomStateInitialized),\n/* harmony export */   INTERNAL_isPendingPromise: () => (/* binding */ INTERNAL_isPendingPromise),\n/* harmony export */   INTERNAL_isPromiseLike: () => (/* binding */ INTERNAL_isPromiseLike),\n/* harmony export */   INTERNAL_isSelfAtom: () => (/* binding */ INTERNAL_isSelfAtom),\n/* harmony export */   INTERNAL_promiseStateMap: () => (/* binding */ INTERNAL_promiseStateMap),\n/* harmony export */   INTERNAL_registerAbortHandler: () => (/* binding */ INTERNAL_registerAbortHandler),\n/* harmony export */   INTERNAL_returnAtomValue: () => (/* binding */ INTERNAL_returnAtomValue),\n/* harmony export */   INTERNAL_setAtomStateValueOrPromise: () => (/* binding */ INTERNAL_setAtomStateValueOrPromise)\n/* harmony export */ });\nconst isSelfAtom = (atom, a) => atom.unstable_is ? atom.unstable_is(a) : a === atom;\nconst hasInitialValue = (atom) => \"init\" in atom;\nconst isActuallyWritableAtom = (atom) => !!atom.write;\nconst isAtomStateInitialized = (atomState) => \"v\" in atomState || \"e\" in atomState;\nconst returnAtomValue = (atomState) => {\n  if (\"e\" in atomState) {\n    throw atomState.e;\n  }\n  if (( false ? 0 : void 0) !== \"production\" && !(\"v\" in atomState)) {\n    throw new Error(\"[Bug] atom state is not initialized\");\n  }\n  return atomState.v;\n};\nconst promiseStateMap = /* @__PURE__ */ new WeakMap();\nconst isPendingPromise = (value) => {\n  var _a;\n  return isPromiseLike(value) && !!((_a = promiseStateMap.get(value)) == null ? void 0 : _a[0]);\n};\nconst abortPromise = (promise) => {\n  const promiseState = promiseStateMap.get(promise);\n  if (promiseState == null ? void 0 : promiseState[0]) {\n    promiseState[0] = false;\n    promiseState[1].forEach((fn) => fn());\n  }\n};\nconst registerAbortHandler = (promise, abortHandler) => {\n  let promiseState = promiseStateMap.get(promise);\n  if (!promiseState) {\n    promiseState = [true, /* @__PURE__ */ new Set()];\n    promiseStateMap.set(promise, promiseState);\n    const settle = () => {\n      promiseState[0] = false;\n    };\n    promise.then(settle, settle);\n  }\n  promiseState[1].add(abortHandler);\n};\nconst isPromiseLike = (p) => typeof (p == null ? void 0 : p.then) === \"function\";\nconst addPendingPromiseToDependency = (atom, promise, dependencyAtomState) => {\n  if (!dependencyAtomState.p.has(atom)) {\n    dependencyAtomState.p.add(atom);\n    promise.then(\n      () => {\n        dependencyAtomState.p.delete(atom);\n      },\n      () => {\n        dependencyAtomState.p.delete(atom);\n      }\n    );\n  }\n};\nconst setAtomStateValueOrPromise = (atom, valueOrPromise, ensureAtomState) => {\n  const atomState = ensureAtomState(atom);\n  const hasPrevValue = \"v\" in atomState;\n  const prevValue = atomState.v;\n  if (isPromiseLike(valueOrPromise)) {\n    for (const a of atomState.d.keys()) {\n      addPendingPromiseToDependency(atom, valueOrPromise, ensureAtomState(a));\n    }\n  }\n  atomState.v = valueOrPromise;\n  delete atomState.e;\n  if (!hasPrevValue || !Object.is(prevValue, atomState.v)) {\n    ++atomState.n;\n    if (isPromiseLike(prevValue)) {\n      abortPromise(prevValue);\n    }\n  }\n};\nconst getMountedOrPendingDependents = (atom, atomState, mountedMap) => {\n  var _a;\n  const dependents = /* @__PURE__ */ new Set();\n  for (const a of ((_a = mountedMap.get(atom)) == null ? void 0 : _a.t) || []) {\n    if (mountedMap.has(a)) {\n      dependents.add(a);\n    }\n  }\n  for (const atomWithPendingPromise of atomState.p) {\n    dependents.add(atomWithPendingPromise);\n  }\n  return dependents;\n};\nconst createStoreHook = () => {\n  const callbacks = /* @__PURE__ */ new Set();\n  const notify = () => {\n    callbacks.forEach((fn) => fn());\n  };\n  notify.add = (fn) => {\n    callbacks.add(fn);\n    return () => {\n      callbacks.delete(fn);\n    };\n  };\n  return notify;\n};\nconst createStoreHookForAtoms = () => {\n  const all = {};\n  const callbacks = /* @__PURE__ */ new WeakMap();\n  const notify = (atom) => {\n    var _a, _b;\n    (_a = callbacks.get(all)) == null ? void 0 : _a.forEach((fn) => fn(atom));\n    (_b = callbacks.get(atom)) == null ? void 0 : _b.forEach((fn) => fn());\n  };\n  notify.add = (atom, fn) => {\n    const key = atom || all;\n    const fns = (callbacks.has(key) ? callbacks : callbacks.set(key, /* @__PURE__ */ new Set())).get(key);\n    fns.add(fn);\n    return () => {\n      fns == null ? void 0 : fns.delete(fn);\n      if (!fns.size) {\n        callbacks.delete(key);\n      }\n    };\n  };\n  return notify;\n};\nconst initializeStoreHooks = (storeHooks) => {\n  storeHooks.c || (storeHooks.c = createStoreHookForAtoms());\n  storeHooks.m || (storeHooks.m = createStoreHookForAtoms());\n  storeHooks.u || (storeHooks.u = createStoreHookForAtoms());\n  storeHooks.f || (storeHooks.f = createStoreHook());\n  return storeHooks;\n};\nconst BUILDING_BLOCKS = Symbol();\nconst getBuildingBlocks = (store) => store[BUILDING_BLOCKS];\nconst buildStore = (atomStateMap = /* @__PURE__ */ new WeakMap(), mountedMap = /* @__PURE__ */ new WeakMap(), invalidatedAtoms = /* @__PURE__ */ new WeakMap(), changedAtoms = /* @__PURE__ */ new Set(), mountCallbacks = /* @__PURE__ */ new Set(), unmountCallbacks = /* @__PURE__ */ new Set(), storeHooks = {}, atomRead = (atom, ...params) => atom.read(...params), atomWrite = (atom, ...params) => atom.write(...params), atomOnInit = (atom, store) => {\n  var _a;\n  return (_a = atom.unstable_onInit) == null ? void 0 : _a.call(atom, store);\n}, atomOnMount = (atom, setAtom) => {\n  var _a;\n  return (_a = atom.onMount) == null ? void 0 : _a.call(atom, setAtom);\n}, ...buildingBlockFunctions) => {\n  const ensureAtomState = buildingBlockFunctions[0] || ((atom) => {\n    if (( false ? 0 : void 0) !== \"production\" && !atom) {\n      throw new Error(\"Atom is undefined or null\");\n    }\n    let atomState = atomStateMap.get(atom);\n    if (!atomState) {\n      atomState = { d: /* @__PURE__ */ new Map(), p: /* @__PURE__ */ new Set(), n: 0 };\n      atomStateMap.set(atom, atomState);\n      atomOnInit == null ? void 0 : atomOnInit(atom, store);\n    }\n    return atomState;\n  });\n  const flushCallbacks = buildingBlockFunctions[1] || (() => {\n    const errors = [];\n    const call = (fn) => {\n      try {\n        fn();\n      } catch (e) {\n        errors.push(e);\n      }\n    };\n    do {\n      if (storeHooks.f) {\n        call(storeHooks.f);\n      }\n      const callbacks = /* @__PURE__ */ new Set();\n      const add = callbacks.add.bind(callbacks);\n      changedAtoms.forEach((atom) => {\n        var _a;\n        return (_a = mountedMap.get(atom)) == null ? void 0 : _a.l.forEach(add);\n      });\n      changedAtoms.clear();\n      unmountCallbacks.forEach(add);\n      unmountCallbacks.clear();\n      mountCallbacks.forEach(add);\n      mountCallbacks.clear();\n      callbacks.forEach(call);\n      if (changedAtoms.size) {\n        recomputeInvalidatedAtoms();\n      }\n    } while (changedAtoms.size || unmountCallbacks.size || mountCallbacks.size);\n    if (errors.length) {\n      throw new AggregateError(errors);\n    }\n  });\n  const recomputeInvalidatedAtoms = buildingBlockFunctions[2] || (() => {\n    const topSortedReversed = [];\n    const visiting = /* @__PURE__ */ new WeakSet();\n    const visited = /* @__PURE__ */ new WeakSet();\n    const stack = Array.from(changedAtoms);\n    while (stack.length) {\n      const a = stack[stack.length - 1];\n      const aState = ensureAtomState(a);\n      if (visited.has(a)) {\n        stack.pop();\n        continue;\n      }\n      if (visiting.has(a)) {\n        if (invalidatedAtoms.get(a) === aState.n) {\n          topSortedReversed.push([a, aState]);\n        } else if (( false ? 0 : void 0) !== \"production\" && invalidatedAtoms.has(a)) {\n          throw new Error(\"[Bug] invalidated atom exists\");\n        }\n        visited.add(a);\n        stack.pop();\n        continue;\n      }\n      visiting.add(a);\n      for (const d of getMountedOrPendingDependents(a, aState, mountedMap)) {\n        if (!visiting.has(d)) {\n          stack.push(d);\n        }\n      }\n    }\n    for (let i = topSortedReversed.length - 1; i >= 0; --i) {\n      const [a, aState] = topSortedReversed[i];\n      let hasChangedDeps = false;\n      for (const dep of aState.d.keys()) {\n        if (dep !== a && changedAtoms.has(dep)) {\n          hasChangedDeps = true;\n          break;\n        }\n      }\n      if (hasChangedDeps) {\n        readAtomState(a);\n        mountDependencies(a);\n      }\n      invalidatedAtoms.delete(a);\n    }\n  });\n  const readAtomState = buildingBlockFunctions[3] || ((atom) => {\n    var _a;\n    const atomState = ensureAtomState(atom);\n    if (isAtomStateInitialized(atomState)) {\n      if (mountedMap.has(atom) && invalidatedAtoms.get(atom) !== atomState.n) {\n        return atomState;\n      }\n      if (Array.from(atomState.d).every(\n        ([a, n]) => (\n          // Recursively, read the atom state of the dependency, and\n          // check if the atom epoch number is unchanged\n          readAtomState(a).n === n\n        )\n      )) {\n        return atomState;\n      }\n    }\n    atomState.d.clear();\n    let isSync = true;\n    const mountDependenciesIfAsync = () => {\n      if (mountedMap.has(atom)) {\n        mountDependencies(atom);\n        recomputeInvalidatedAtoms();\n        flushCallbacks();\n      }\n    };\n    const getter = (a) => {\n      var _a2;\n      if (isSelfAtom(atom, a)) {\n        const aState2 = ensureAtomState(a);\n        if (!isAtomStateInitialized(aState2)) {\n          if (hasInitialValue(a)) {\n            setAtomStateValueOrPromise(a, a.init, ensureAtomState);\n          } else {\n            throw new Error(\"no atom init\");\n          }\n        }\n        return returnAtomValue(aState2);\n      }\n      const aState = readAtomState(a);\n      try {\n        return returnAtomValue(aState);\n      } finally {\n        atomState.d.set(a, aState.n);\n        if (isPendingPromise(atomState.v)) {\n          addPendingPromiseToDependency(atom, atomState.v, aState);\n        }\n        (_a2 = mountedMap.get(a)) == null ? void 0 : _a2.t.add(atom);\n        if (!isSync) {\n          mountDependenciesIfAsync();\n        }\n      }\n    };\n    let controller;\n    let setSelf;\n    const options = {\n      get signal() {\n        if (!controller) {\n          controller = new AbortController();\n        }\n        return controller.signal;\n      },\n      get setSelf() {\n        if (( false ? 0 : void 0) !== \"production\" && !isActuallyWritableAtom(atom)) {\n          console.warn(\"setSelf function cannot be used with read-only atom\");\n        }\n        if (!setSelf && isActuallyWritableAtom(atom)) {\n          setSelf = (...args) => {\n            if (( false ? 0 : void 0) !== \"production\" && isSync) {\n              console.warn(\"setSelf function cannot be called in sync\");\n            }\n            if (!isSync) {\n              try {\n                return writeAtomState(atom, ...args);\n              } finally {\n                recomputeInvalidatedAtoms();\n                flushCallbacks();\n              }\n            }\n          };\n        }\n        return setSelf;\n      }\n    };\n    const prevEpochNumber = atomState.n;\n    try {\n      const valueOrPromise = atomRead(atom, getter, options);\n      setAtomStateValueOrPromise(atom, valueOrPromise, ensureAtomState);\n      if (isPromiseLike(valueOrPromise)) {\n        registerAbortHandler(valueOrPromise, () => controller == null ? void 0 : controller.abort());\n        valueOrPromise.then(\n          mountDependenciesIfAsync,\n          mountDependenciesIfAsync\n        );\n      }\n      return atomState;\n    } catch (error) {\n      delete atomState.v;\n      atomState.e = error;\n      ++atomState.n;\n      return atomState;\n    } finally {\n      isSync = false;\n      if (prevEpochNumber !== atomState.n && invalidatedAtoms.get(atom) === prevEpochNumber) {\n        invalidatedAtoms.set(atom, atomState.n);\n        changedAtoms.add(atom);\n        (_a = storeHooks.c) == null ? void 0 : _a.call(storeHooks, atom);\n      }\n    }\n  });\n  const invalidateDependents = buildingBlockFunctions[4] || ((atom) => {\n    const stack = [atom];\n    while (stack.length) {\n      const a = stack.pop();\n      const aState = ensureAtomState(a);\n      for (const d of getMountedOrPendingDependents(a, aState, mountedMap)) {\n        const dState = ensureAtomState(d);\n        invalidatedAtoms.set(d, dState.n);\n        stack.push(d);\n      }\n    }\n  });\n  const writeAtomState = buildingBlockFunctions[5] || ((atom, ...args) => {\n    let isSync = true;\n    const getter = (a) => returnAtomValue(readAtomState(a));\n    const setter = (a, ...args2) => {\n      var _a;\n      const aState = ensureAtomState(a);\n      try {\n        if (isSelfAtom(atom, a)) {\n          if (!hasInitialValue(a)) {\n            throw new Error(\"atom not writable\");\n          }\n          const prevEpochNumber = aState.n;\n          const v = args2[0];\n          setAtomStateValueOrPromise(a, v, ensureAtomState);\n          mountDependencies(a);\n          if (prevEpochNumber !== aState.n) {\n            changedAtoms.add(a);\n            (_a = storeHooks.c) == null ? void 0 : _a.call(storeHooks, a);\n            invalidateDependents(a);\n          }\n          return void 0;\n        } else {\n          return writeAtomState(a, ...args2);\n        }\n      } finally {\n        if (!isSync) {\n          recomputeInvalidatedAtoms();\n          flushCallbacks();\n        }\n      }\n    };\n    try {\n      return atomWrite(atom, getter, setter, ...args);\n    } finally {\n      isSync = false;\n    }\n  });\n  const mountDependencies = buildingBlockFunctions[6] || ((atom) => {\n    var _a;\n    const atomState = ensureAtomState(atom);\n    const mounted = mountedMap.get(atom);\n    if (mounted && !isPendingPromise(atomState.v)) {\n      for (const [a, n] of atomState.d) {\n        if (!mounted.d.has(a)) {\n          const aState = ensureAtomState(a);\n          const aMounted = mountAtom(a);\n          aMounted.t.add(atom);\n          mounted.d.add(a);\n          if (n !== aState.n) {\n            changedAtoms.add(a);\n            (_a = storeHooks.c) == null ? void 0 : _a.call(storeHooks, a);\n            invalidateDependents(a);\n          }\n        }\n      }\n      for (const a of mounted.d || []) {\n        if (!atomState.d.has(a)) {\n          mounted.d.delete(a);\n          const aMounted = unmountAtom(a);\n          aMounted == null ? void 0 : aMounted.t.delete(atom);\n        }\n      }\n    }\n  });\n  const mountAtom = buildingBlockFunctions[7] || ((atom) => {\n    var _a;\n    const atomState = ensureAtomState(atom);\n    let mounted = mountedMap.get(atom);\n    if (!mounted) {\n      readAtomState(atom);\n      for (const a of atomState.d.keys()) {\n        const aMounted = mountAtom(a);\n        aMounted.t.add(atom);\n      }\n      mounted = {\n        l: /* @__PURE__ */ new Set(),\n        d: new Set(atomState.d.keys()),\n        t: /* @__PURE__ */ new Set()\n      };\n      mountedMap.set(atom, mounted);\n      (_a = storeHooks.m) == null ? void 0 : _a.call(storeHooks, atom);\n      if (isActuallyWritableAtom(atom)) {\n        const processOnMount = () => {\n          let isSync = true;\n          const setAtom = (...args) => {\n            try {\n              return writeAtomState(atom, ...args);\n            } finally {\n              if (!isSync) {\n                recomputeInvalidatedAtoms();\n                flushCallbacks();\n              }\n            }\n          };\n          try {\n            const onUnmount = atomOnMount(atom, setAtom);\n            if (onUnmount) {\n              mounted.u = () => {\n                isSync = true;\n                try {\n                  onUnmount();\n                } finally {\n                  isSync = false;\n                }\n              };\n            }\n          } finally {\n            isSync = false;\n          }\n        };\n        mountCallbacks.add(processOnMount);\n      }\n    }\n    return mounted;\n  });\n  const unmountAtom = buildingBlockFunctions[8] || ((atom) => {\n    var _a;\n    const atomState = ensureAtomState(atom);\n    let mounted = mountedMap.get(atom);\n    if (mounted && !mounted.l.size && !Array.from(mounted.t).some((a) => {\n      var _a2;\n      return (_a2 = mountedMap.get(a)) == null ? void 0 : _a2.d.has(atom);\n    })) {\n      if (mounted.u) {\n        unmountCallbacks.add(mounted.u);\n      }\n      mounted = void 0;\n      mountedMap.delete(atom);\n      (_a = storeHooks.u) == null ? void 0 : _a.call(storeHooks, atom);\n      for (const a of atomState.d.keys()) {\n        const aMounted = unmountAtom(a);\n        aMounted == null ? void 0 : aMounted.t.delete(atom);\n      }\n      return void 0;\n    }\n    return mounted;\n  });\n  const buildingBlocks = [\n    // store state\n    atomStateMap,\n    mountedMap,\n    invalidatedAtoms,\n    changedAtoms,\n    mountCallbacks,\n    unmountCallbacks,\n    storeHooks,\n    // atom interceptors\n    atomRead,\n    atomWrite,\n    atomOnInit,\n    atomOnMount,\n    // building-block functions\n    ensureAtomState,\n    flushCallbacks,\n    recomputeInvalidatedAtoms,\n    readAtomState,\n    invalidateDependents,\n    writeAtomState,\n    mountDependencies,\n    mountAtom,\n    unmountAtom\n  ];\n  const store = {\n    get: (atom) => returnAtomValue(readAtomState(atom)),\n    set: (atom, ...args) => {\n      try {\n        return writeAtomState(atom, ...args);\n      } finally {\n        recomputeInvalidatedAtoms();\n        flushCallbacks();\n      }\n    },\n    sub: (atom, listener) => {\n      const mounted = mountAtom(atom);\n      const listeners = mounted.l;\n      listeners.add(listener);\n      flushCallbacks();\n      return () => {\n        listeners.delete(listener);\n        unmountAtom(atom);\n        flushCallbacks();\n      };\n    }\n  };\n  Object.defineProperty(store, BUILDING_BLOCKS, { value: buildingBlocks });\n  return store;\n};\nconst INTERNAL_buildStoreRev1 = buildStore;\nconst INTERNAL_getBuildingBlocksRev1 = getBuildingBlocks;\nconst INTERNAL_initializeStoreHooks = initializeStoreHooks;\nconst INTERNAL_isSelfAtom = isSelfAtom;\nconst INTERNAL_hasInitialValue = hasInitialValue;\nconst INTERNAL_isActuallyWritableAtom = isActuallyWritableAtom;\nconst INTERNAL_isAtomStateInitialized = isAtomStateInitialized;\nconst INTERNAL_returnAtomValue = returnAtomValue;\nconst INTERNAL_promiseStateMap = promiseStateMap;\nconst INTERNAL_isPendingPromise = isPendingPromise;\nconst INTERNAL_abortPromise = abortPromise;\nconst INTERNAL_registerAbortHandler = registerAbortHandler;\nconst INTERNAL_isPromiseLike = isPromiseLike;\nconst INTERNAL_addPendingPromiseToDependency = addPendingPromiseToDependency;\nconst INTERNAL_setAtomStateValueOrPromise = setAtomStateValueOrPromise;\nconst INTERNAL_getMountedOrPendingDependents = getMountedOrPendingDependents;\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vam90YWlAMi4xMi41X0B0eXBlcytyZWFjdEAxOC4zLjIzX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvam90YWkvZXNtL3ZhbmlsbGEvaW50ZXJuYWxzLm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sTUFBZSxHQUFHLENBQW9CO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1UQUFtVDtBQUNuVDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxTQUFTLE1BQWUsR0FBRyxDQUFvQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsVUFBVSxNQUFlLEdBQUcsQ0FBb0I7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsUUFBUTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLGFBQWEsTUFBZSxHQUFHLENBQW9CO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE1BQWUsR0FBRyxDQUFvQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsdUJBQXVCO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFcWUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb3R1aS8uL25vZGVfbW9kdWxlcy8ucG5wbS9qb3RhaUAyLjEyLjVfQHR5cGVzK3JlYWN0QDE4LjMuMjNfcmVhY3RAMTguMy4xL25vZGVfbW9kdWxlcy9qb3RhaS9lc20vdmFuaWxsYS9pbnRlcm5hbHMubWpzPzRmMzAiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaXNTZWxmQXRvbSA9IChhdG9tLCBhKSA9PiBhdG9tLnVuc3RhYmxlX2lzID8gYXRvbS51bnN0YWJsZV9pcyhhKSA6IGEgPT09IGF0b207XG5jb25zdCBoYXNJbml0aWFsVmFsdWUgPSAoYXRvbSkgPT4gXCJpbml0XCIgaW4gYXRvbTtcbmNvbnN0IGlzQWN0dWFsbHlXcml0YWJsZUF0b20gPSAoYXRvbSkgPT4gISFhdG9tLndyaXRlO1xuY29uc3QgaXNBdG9tU3RhdGVJbml0aWFsaXplZCA9IChhdG9tU3RhdGUpID0+IFwidlwiIGluIGF0b21TdGF0ZSB8fCBcImVcIiBpbiBhdG9tU3RhdGU7XG5jb25zdCByZXR1cm5BdG9tVmFsdWUgPSAoYXRvbVN0YXRlKSA9PiB7XG4gIGlmIChcImVcIiBpbiBhdG9tU3RhdGUpIHtcbiAgICB0aHJvdyBhdG9tU3RhdGUuZTtcbiAgfVxuICBpZiAoKGltcG9ydC5tZXRhLmVudiA/IGltcG9ydC5tZXRhLmVudi5NT0RFIDogdm9pZCAwKSAhPT0gXCJwcm9kdWN0aW9uXCIgJiYgIShcInZcIiBpbiBhdG9tU3RhdGUpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiW0J1Z10gYXRvbSBzdGF0ZSBpcyBub3QgaW5pdGlhbGl6ZWRcIik7XG4gIH1cbiAgcmV0dXJuIGF0b21TdGF0ZS52O1xufTtcbmNvbnN0IHByb21pc2VTdGF0ZU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpO1xuY29uc3QgaXNQZW5kaW5nUHJvbWlzZSA9ICh2YWx1ZSkgPT4ge1xuICB2YXIgX2E7XG4gIHJldHVybiBpc1Byb21pc2VMaWtlKHZhbHVlKSAmJiAhISgoX2EgPSBwcm9taXNlU3RhdGVNYXAuZ2V0KHZhbHVlKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hWzBdKTtcbn07XG5jb25zdCBhYm9ydFByb21pc2UgPSAocHJvbWlzZSkgPT4ge1xuICBjb25zdCBwcm9taXNlU3RhdGUgPSBwcm9taXNlU3RhdGVNYXAuZ2V0KHByb21pc2UpO1xuICBpZiAocHJvbWlzZVN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBwcm9taXNlU3RhdGVbMF0pIHtcbiAgICBwcm9taXNlU3RhdGVbMF0gPSBmYWxzZTtcbiAgICBwcm9taXNlU3RhdGVbMV0uZm9yRWFjaCgoZm4pID0+IGZuKCkpO1xuICB9XG59O1xuY29uc3QgcmVnaXN0ZXJBYm9ydEhhbmRsZXIgPSAocHJvbWlzZSwgYWJvcnRIYW5kbGVyKSA9PiB7XG4gIGxldCBwcm9taXNlU3RhdGUgPSBwcm9taXNlU3RhdGVNYXAuZ2V0KHByb21pc2UpO1xuICBpZiAoIXByb21pc2VTdGF0ZSkge1xuICAgIHByb21pc2VTdGF0ZSA9IFt0cnVlLCAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpXTtcbiAgICBwcm9taXNlU3RhdGVNYXAuc2V0KHByb21pc2UsIHByb21pc2VTdGF0ZSk7XG4gICAgY29uc3Qgc2V0dGxlID0gKCkgPT4ge1xuICAgICAgcHJvbWlzZVN0YXRlWzBdID0gZmFsc2U7XG4gICAgfTtcbiAgICBwcm9taXNlLnRoZW4oc2V0dGxlLCBzZXR0bGUpO1xuICB9XG4gIHByb21pc2VTdGF0ZVsxXS5hZGQoYWJvcnRIYW5kbGVyKTtcbn07XG5jb25zdCBpc1Byb21pc2VMaWtlID0gKHApID0+IHR5cGVvZiAocCA9PSBudWxsID8gdm9pZCAwIDogcC50aGVuKSA9PT0gXCJmdW5jdGlvblwiO1xuY29uc3QgYWRkUGVuZGluZ1Byb21pc2VUb0RlcGVuZGVuY3kgPSAoYXRvbSwgcHJvbWlzZSwgZGVwZW5kZW5jeUF0b21TdGF0ZSkgPT4ge1xuICBpZiAoIWRlcGVuZGVuY3lBdG9tU3RhdGUucC5oYXMoYXRvbSkpIHtcbiAgICBkZXBlbmRlbmN5QXRvbVN0YXRlLnAuYWRkKGF0b20pO1xuICAgIHByb21pc2UudGhlbihcbiAgICAgICgpID0+IHtcbiAgICAgICAgZGVwZW5kZW5jeUF0b21TdGF0ZS5wLmRlbGV0ZShhdG9tKTtcbiAgICAgIH0sXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGRlcGVuZGVuY3lBdG9tU3RhdGUucC5kZWxldGUoYXRvbSk7XG4gICAgICB9XG4gICAgKTtcbiAgfVxufTtcbmNvbnN0IHNldEF0b21TdGF0ZVZhbHVlT3JQcm9taXNlID0gKGF0b20sIHZhbHVlT3JQcm9taXNlLCBlbnN1cmVBdG9tU3RhdGUpID0+IHtcbiAgY29uc3QgYXRvbVN0YXRlID0gZW5zdXJlQXRvbVN0YXRlKGF0b20pO1xuICBjb25zdCBoYXNQcmV2VmFsdWUgPSBcInZcIiBpbiBhdG9tU3RhdGU7XG4gIGNvbnN0IHByZXZWYWx1ZSA9IGF0b21TdGF0ZS52O1xuICBpZiAoaXNQcm9taXNlTGlrZSh2YWx1ZU9yUHJvbWlzZSkpIHtcbiAgICBmb3IgKGNvbnN0IGEgb2YgYXRvbVN0YXRlLmQua2V5cygpKSB7XG4gICAgICBhZGRQZW5kaW5nUHJvbWlzZVRvRGVwZW5kZW5jeShhdG9tLCB2YWx1ZU9yUHJvbWlzZSwgZW5zdXJlQXRvbVN0YXRlKGEpKTtcbiAgICB9XG4gIH1cbiAgYXRvbVN0YXRlLnYgPSB2YWx1ZU9yUHJvbWlzZTtcbiAgZGVsZXRlIGF0b21TdGF0ZS5lO1xuICBpZiAoIWhhc1ByZXZWYWx1ZSB8fCAhT2JqZWN0LmlzKHByZXZWYWx1ZSwgYXRvbVN0YXRlLnYpKSB7XG4gICAgKythdG9tU3RhdGUubjtcbiAgICBpZiAoaXNQcm9taXNlTGlrZShwcmV2VmFsdWUpKSB7XG4gICAgICBhYm9ydFByb21pc2UocHJldlZhbHVlKTtcbiAgICB9XG4gIH1cbn07XG5jb25zdCBnZXRNb3VudGVkT3JQZW5kaW5nRGVwZW5kZW50cyA9IChhdG9tLCBhdG9tU3RhdGUsIG1vdW50ZWRNYXApID0+IHtcbiAgdmFyIF9hO1xuICBjb25zdCBkZXBlbmRlbnRzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgZm9yIChjb25zdCBhIG9mICgoX2EgPSBtb3VudGVkTWFwLmdldChhdG9tKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnQpIHx8IFtdKSB7XG4gICAgaWYgKG1vdW50ZWRNYXAuaGFzKGEpKSB7XG4gICAgICBkZXBlbmRlbnRzLmFkZChhKTtcbiAgICB9XG4gIH1cbiAgZm9yIChjb25zdCBhdG9tV2l0aFBlbmRpbmdQcm9taXNlIG9mIGF0b21TdGF0ZS5wKSB7XG4gICAgZGVwZW5kZW50cy5hZGQoYXRvbVdpdGhQZW5kaW5nUHJvbWlzZSk7XG4gIH1cbiAgcmV0dXJuIGRlcGVuZGVudHM7XG59O1xuY29uc3QgY3JlYXRlU3RvcmVIb29rID0gKCkgPT4ge1xuICBjb25zdCBjYWxsYmFja3MgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBjb25zdCBub3RpZnkgPSAoKSA9PiB7XG4gICAgY2FsbGJhY2tzLmZvckVhY2goKGZuKSA9PiBmbigpKTtcbiAgfTtcbiAgbm90aWZ5LmFkZCA9IChmbikgPT4ge1xuICAgIGNhbGxiYWNrcy5hZGQoZm4pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjYWxsYmFja3MuZGVsZXRlKGZuKTtcbiAgICB9O1xuICB9O1xuICByZXR1cm4gbm90aWZ5O1xufTtcbmNvbnN0IGNyZWF0ZVN0b3JlSG9va0ZvckF0b21zID0gKCkgPT4ge1xuICBjb25zdCBhbGwgPSB7fTtcbiAgY29uc3QgY2FsbGJhY2tzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG4gIGNvbnN0IG5vdGlmeSA9IChhdG9tKSA9PiB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICAoX2EgPSBjYWxsYmFja3MuZ2V0KGFsbCkpID09IG51bGwgPyB2b2lkIDAgOiBfYS5mb3JFYWNoKChmbikgPT4gZm4oYXRvbSkpO1xuICAgIChfYiA9IGNhbGxiYWNrcy5nZXQoYXRvbSkpID09IG51bGwgPyB2b2lkIDAgOiBfYi5mb3JFYWNoKChmbikgPT4gZm4oKSk7XG4gIH07XG4gIG5vdGlmeS5hZGQgPSAoYXRvbSwgZm4pID0+IHtcbiAgICBjb25zdCBrZXkgPSBhdG9tIHx8IGFsbDtcbiAgICBjb25zdCBmbnMgPSAoY2FsbGJhY2tzLmhhcyhrZXkpID8gY2FsbGJhY2tzIDogY2FsbGJhY2tzLnNldChrZXksIC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkpKS5nZXQoa2V5KTtcbiAgICBmbnMuYWRkKGZuKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgZm5zID09IG51bGwgPyB2b2lkIDAgOiBmbnMuZGVsZXRlKGZuKTtcbiAgICAgIGlmICghZm5zLnNpemUpIHtcbiAgICAgICAgY2FsbGJhY2tzLmRlbGV0ZShrZXkpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG4gIHJldHVybiBub3RpZnk7XG59O1xuY29uc3QgaW5pdGlhbGl6ZVN0b3JlSG9va3MgPSAoc3RvcmVIb29rcykgPT4ge1xuICBzdG9yZUhvb2tzLmMgfHwgKHN0b3JlSG9va3MuYyA9IGNyZWF0ZVN0b3JlSG9va0ZvckF0b21zKCkpO1xuICBzdG9yZUhvb2tzLm0gfHwgKHN0b3JlSG9va3MubSA9IGNyZWF0ZVN0b3JlSG9va0ZvckF0b21zKCkpO1xuICBzdG9yZUhvb2tzLnUgfHwgKHN0b3JlSG9va3MudSA9IGNyZWF0ZVN0b3JlSG9va0ZvckF0b21zKCkpO1xuICBzdG9yZUhvb2tzLmYgfHwgKHN0b3JlSG9va3MuZiA9IGNyZWF0ZVN0b3JlSG9vaygpKTtcbiAgcmV0dXJuIHN0b3JlSG9va3M7XG59O1xuY29uc3QgQlVJTERJTkdfQkxPQ0tTID0gU3ltYm9sKCk7XG5jb25zdCBnZXRCdWlsZGluZ0Jsb2NrcyA9IChzdG9yZSkgPT4gc3RvcmVbQlVJTERJTkdfQkxPQ0tTXTtcbmNvbnN0IGJ1aWxkU3RvcmUgPSAoYXRvbVN0YXRlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCksIG1vdW50ZWRNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKSwgaW52YWxpZGF0ZWRBdG9tcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpLCBjaGFuZ2VkQXRvbXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpLCBtb3VudENhbGxiYWNrcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCksIHVubW91bnRDYWxsYmFja3MgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpLCBzdG9yZUhvb2tzID0ge30sIGF0b21SZWFkID0gKGF0b20sIC4uLnBhcmFtcykgPT4gYXRvbS5yZWFkKC4uLnBhcmFtcyksIGF0b21Xcml0ZSA9IChhdG9tLCAuLi5wYXJhbXMpID0+IGF0b20ud3JpdGUoLi4ucGFyYW1zKSwgYXRvbU9uSW5pdCA9IChhdG9tLCBzdG9yZSkgPT4ge1xuICB2YXIgX2E7XG4gIHJldHVybiAoX2EgPSBhdG9tLnVuc3RhYmxlX29uSW5pdCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwoYXRvbSwgc3RvcmUpO1xufSwgYXRvbU9uTW91bnQgPSAoYXRvbSwgc2V0QXRvbSkgPT4ge1xuICB2YXIgX2E7XG4gIHJldHVybiAoX2EgPSBhdG9tLm9uTW91bnQpID09IG51bGwgPyB2b2lkIDAgOiBfYS5jYWxsKGF0b20sIHNldEF0b20pO1xufSwgLi4uYnVpbGRpbmdCbG9ja0Z1bmN0aW9ucykgPT4ge1xuICBjb25zdCBlbnN1cmVBdG9tU3RhdGUgPSBidWlsZGluZ0Jsb2NrRnVuY3Rpb25zWzBdIHx8ICgoYXRvbSkgPT4ge1xuICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIiAmJiAhYXRvbSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXRvbSBpcyB1bmRlZmluZWQgb3IgbnVsbFwiKTtcbiAgICB9XG4gICAgbGV0IGF0b21TdGF0ZSA9IGF0b21TdGF0ZU1hcC5nZXQoYXRvbSk7XG4gICAgaWYgKCFhdG9tU3RhdGUpIHtcbiAgICAgIGF0b21TdGF0ZSA9IHsgZDogLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSwgcDogLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSwgbjogMCB9O1xuICAgICAgYXRvbVN0YXRlTWFwLnNldChhdG9tLCBhdG9tU3RhdGUpO1xuICAgICAgYXRvbU9uSW5pdCA9PSBudWxsID8gdm9pZCAwIDogYXRvbU9uSW5pdChhdG9tLCBzdG9yZSk7XG4gICAgfVxuICAgIHJldHVybiBhdG9tU3RhdGU7XG4gIH0pO1xuICBjb25zdCBmbHVzaENhbGxiYWNrcyA9IGJ1aWxkaW5nQmxvY2tGdW5jdGlvbnNbMV0gfHwgKCgpID0+IHtcbiAgICBjb25zdCBlcnJvcnMgPSBbXTtcbiAgICBjb25zdCBjYWxsID0gKGZuKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBmbigpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBlcnJvcnMucHVzaChlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGRvIHtcbiAgICAgIGlmIChzdG9yZUhvb2tzLmYpIHtcbiAgICAgICAgY2FsbChzdG9yZUhvb2tzLmYpO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FsbGJhY2tzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICAgIGNvbnN0IGFkZCA9IGNhbGxiYWNrcy5hZGQuYmluZChjYWxsYmFja3MpO1xuICAgICAgY2hhbmdlZEF0b21zLmZvckVhY2goKGF0b20pID0+IHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gKF9hID0gbW91bnRlZE1hcC5nZXQoYXRvbSkpID09IG51bGwgPyB2b2lkIDAgOiBfYS5sLmZvckVhY2goYWRkKTtcbiAgICAgIH0pO1xuICAgICAgY2hhbmdlZEF0b21zLmNsZWFyKCk7XG4gICAgICB1bm1vdW50Q2FsbGJhY2tzLmZvckVhY2goYWRkKTtcbiAgICAgIHVubW91bnRDYWxsYmFja3MuY2xlYXIoKTtcbiAgICAgIG1vdW50Q2FsbGJhY2tzLmZvckVhY2goYWRkKTtcbiAgICAgIG1vdW50Q2FsbGJhY2tzLmNsZWFyKCk7XG4gICAgICBjYWxsYmFja3MuZm9yRWFjaChjYWxsKTtcbiAgICAgIGlmIChjaGFuZ2VkQXRvbXMuc2l6ZSkge1xuICAgICAgICByZWNvbXB1dGVJbnZhbGlkYXRlZEF0b21zKCk7XG4gICAgICB9XG4gICAgfSB3aGlsZSAoY2hhbmdlZEF0b21zLnNpemUgfHwgdW5tb3VudENhbGxiYWNrcy5zaXplIHx8IG1vdW50Q2FsbGJhY2tzLnNpemUpO1xuICAgIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgQWdncmVnYXRlRXJyb3IoZXJyb3JzKTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCByZWNvbXB1dGVJbnZhbGlkYXRlZEF0b21zID0gYnVpbGRpbmdCbG9ja0Z1bmN0aW9uc1syXSB8fCAoKCkgPT4ge1xuICAgIGNvbnN0IHRvcFNvcnRlZFJldmVyc2VkID0gW107XG4gICAgY29uc3QgdmlzaXRpbmcgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtTZXQoKTtcbiAgICBjb25zdCB2aXNpdGVkID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrU2V0KCk7XG4gICAgY29uc3Qgc3RhY2sgPSBBcnJheS5mcm9tKGNoYW5nZWRBdG9tcyk7XG4gICAgd2hpbGUgKHN0YWNrLmxlbmd0aCkge1xuICAgICAgY29uc3QgYSA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgY29uc3QgYVN0YXRlID0gZW5zdXJlQXRvbVN0YXRlKGEpO1xuICAgICAgaWYgKHZpc2l0ZWQuaGFzKGEpKSB7XG4gICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmICh2aXNpdGluZy5oYXMoYSkpIHtcbiAgICAgICAgaWYgKGludmFsaWRhdGVkQXRvbXMuZ2V0KGEpID09PSBhU3RhdGUubikge1xuICAgICAgICAgIHRvcFNvcnRlZFJldmVyc2VkLnB1c2goW2EsIGFTdGF0ZV0pO1xuICAgICAgICB9IGVsc2UgaWYgKChpbXBvcnQubWV0YS5lbnYgPyBpbXBvcnQubWV0YS5lbnYuTU9ERSA6IHZvaWQgMCkgIT09IFwicHJvZHVjdGlvblwiICYmIGludmFsaWRhdGVkQXRvbXMuaGFzKGEpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiW0J1Z10gaW52YWxpZGF0ZWQgYXRvbSBleGlzdHNcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmlzaXRlZC5hZGQoYSk7XG4gICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHZpc2l0aW5nLmFkZChhKTtcbiAgICAgIGZvciAoY29uc3QgZCBvZiBnZXRNb3VudGVkT3JQZW5kaW5nRGVwZW5kZW50cyhhLCBhU3RhdGUsIG1vdW50ZWRNYXApKSB7XG4gICAgICAgIGlmICghdmlzaXRpbmcuaGFzKGQpKSB7XG4gICAgICAgICAgc3RhY2sucHVzaChkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGxldCBpID0gdG9wU29ydGVkUmV2ZXJzZWQubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgIGNvbnN0IFthLCBhU3RhdGVdID0gdG9wU29ydGVkUmV2ZXJzZWRbaV07XG4gICAgICBsZXQgaGFzQ2hhbmdlZERlcHMgPSBmYWxzZTtcbiAgICAgIGZvciAoY29uc3QgZGVwIG9mIGFTdGF0ZS5kLmtleXMoKSkge1xuICAgICAgICBpZiAoZGVwICE9PSBhICYmIGNoYW5nZWRBdG9tcy5oYXMoZGVwKSkge1xuICAgICAgICAgIGhhc0NoYW5nZWREZXBzID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGhhc0NoYW5nZWREZXBzKSB7XG4gICAgICAgIHJlYWRBdG9tU3RhdGUoYSk7XG4gICAgICAgIG1vdW50RGVwZW5kZW5jaWVzKGEpO1xuICAgICAgfVxuICAgICAgaW52YWxpZGF0ZWRBdG9tcy5kZWxldGUoYSk7XG4gICAgfVxuICB9KTtcbiAgY29uc3QgcmVhZEF0b21TdGF0ZSA9IGJ1aWxkaW5nQmxvY2tGdW5jdGlvbnNbM10gfHwgKChhdG9tKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IGF0b21TdGF0ZSA9IGVuc3VyZUF0b21TdGF0ZShhdG9tKTtcbiAgICBpZiAoaXNBdG9tU3RhdGVJbml0aWFsaXplZChhdG9tU3RhdGUpKSB7XG4gICAgICBpZiAobW91bnRlZE1hcC5oYXMoYXRvbSkgJiYgaW52YWxpZGF0ZWRBdG9tcy5nZXQoYXRvbSkgIT09IGF0b21TdGF0ZS5uKSB7XG4gICAgICAgIHJldHVybiBhdG9tU3RhdGU7XG4gICAgICB9XG4gICAgICBpZiAoQXJyYXkuZnJvbShhdG9tU3RhdGUuZCkuZXZlcnkoXG4gICAgICAgIChbYSwgbl0pID0+IChcbiAgICAgICAgICAvLyBSZWN1cnNpdmVseSwgcmVhZCB0aGUgYXRvbSBzdGF0ZSBvZiB0aGUgZGVwZW5kZW5jeSwgYW5kXG4gICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGF0b20gZXBvY2ggbnVtYmVyIGlzIHVuY2hhbmdlZFxuICAgICAgICAgIHJlYWRBdG9tU3RhdGUoYSkubiA9PT0gblxuICAgICAgICApXG4gICAgICApKSB7XG4gICAgICAgIHJldHVybiBhdG9tU3RhdGU7XG4gICAgICB9XG4gICAgfVxuICAgIGF0b21TdGF0ZS5kLmNsZWFyKCk7XG4gICAgbGV0IGlzU3luYyA9IHRydWU7XG4gICAgY29uc3QgbW91bnREZXBlbmRlbmNpZXNJZkFzeW5jID0gKCkgPT4ge1xuICAgICAgaWYgKG1vdW50ZWRNYXAuaGFzKGF0b20pKSB7XG4gICAgICAgIG1vdW50RGVwZW5kZW5jaWVzKGF0b20pO1xuICAgICAgICByZWNvbXB1dGVJbnZhbGlkYXRlZEF0b21zKCk7XG4gICAgICAgIGZsdXNoQ2FsbGJhY2tzKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBnZXR0ZXIgPSAoYSkgPT4ge1xuICAgICAgdmFyIF9hMjtcbiAgICAgIGlmIChpc1NlbGZBdG9tKGF0b20sIGEpKSB7XG4gICAgICAgIGNvbnN0IGFTdGF0ZTIgPSBlbnN1cmVBdG9tU3RhdGUoYSk7XG4gICAgICAgIGlmICghaXNBdG9tU3RhdGVJbml0aWFsaXplZChhU3RhdGUyKSkge1xuICAgICAgICAgIGlmIChoYXNJbml0aWFsVmFsdWUoYSkpIHtcbiAgICAgICAgICAgIHNldEF0b21TdGF0ZVZhbHVlT3JQcm9taXNlKGEsIGEuaW5pdCwgZW5zdXJlQXRvbVN0YXRlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibm8gYXRvbSBpbml0XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0dXJuQXRvbVZhbHVlKGFTdGF0ZTIpO1xuICAgICAgfVxuICAgICAgY29uc3QgYVN0YXRlID0gcmVhZEF0b21TdGF0ZShhKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiByZXR1cm5BdG9tVmFsdWUoYVN0YXRlKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGF0b21TdGF0ZS5kLnNldChhLCBhU3RhdGUubik7XG4gICAgICAgIGlmIChpc1BlbmRpbmdQcm9taXNlKGF0b21TdGF0ZS52KSkge1xuICAgICAgICAgIGFkZFBlbmRpbmdQcm9taXNlVG9EZXBlbmRlbmN5KGF0b20sIGF0b21TdGF0ZS52LCBhU3RhdGUpO1xuICAgICAgICB9XG4gICAgICAgIChfYTIgPSBtb3VudGVkTWFwLmdldChhKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi50LmFkZChhdG9tKTtcbiAgICAgICAgaWYgKCFpc1N5bmMpIHtcbiAgICAgICAgICBtb3VudERlcGVuZGVuY2llc0lmQXN5bmMoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgbGV0IGNvbnRyb2xsZXI7XG4gICAgbGV0IHNldFNlbGY7XG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIGdldCBzaWduYWwoKSB7XG4gICAgICAgIGlmICghY29udHJvbGxlcikge1xuICAgICAgICAgIGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXIuc2lnbmFsO1xuICAgICAgfSxcbiAgICAgIGdldCBzZXRTZWxmKCkge1xuICAgICAgICBpZiAoKGltcG9ydC5tZXRhLmVudiA/IGltcG9ydC5tZXRhLmVudi5NT0RFIDogdm9pZCAwKSAhPT0gXCJwcm9kdWN0aW9uXCIgJiYgIWlzQWN0dWFsbHlXcml0YWJsZUF0b20oYXRvbSkpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCJzZXRTZWxmIGZ1bmN0aW9uIGNhbm5vdCBiZSB1c2VkIHdpdGggcmVhZC1vbmx5IGF0b21cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZXRTZWxmICYmIGlzQWN0dWFsbHlXcml0YWJsZUF0b20oYXRvbSkpIHtcbiAgICAgICAgICBzZXRTZWxmID0gKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIiAmJiBpc1N5bmMpIHtcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwic2V0U2VsZiBmdW5jdGlvbiBjYW5ub3QgYmUgY2FsbGVkIGluIHN5bmNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzU3luYykge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiB3cml0ZUF0b21TdGF0ZShhdG9tLCAuLi5hcmdzKTtcbiAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICByZWNvbXB1dGVJbnZhbGlkYXRlZEF0b21zKCk7XG4gICAgICAgICAgICAgICAgZmx1c2hDYWxsYmFja3MoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNldFNlbGY7XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBwcmV2RXBvY2hOdW1iZXIgPSBhdG9tU3RhdGUubjtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdmFsdWVPclByb21pc2UgPSBhdG9tUmVhZChhdG9tLCBnZXR0ZXIsIG9wdGlvbnMpO1xuICAgICAgc2V0QXRvbVN0YXRlVmFsdWVPclByb21pc2UoYXRvbSwgdmFsdWVPclByb21pc2UsIGVuc3VyZUF0b21TdGF0ZSk7XG4gICAgICBpZiAoaXNQcm9taXNlTGlrZSh2YWx1ZU9yUHJvbWlzZSkpIHtcbiAgICAgICAgcmVnaXN0ZXJBYm9ydEhhbmRsZXIodmFsdWVPclByb21pc2UsICgpID0+IGNvbnRyb2xsZXIgPT0gbnVsbCA/IHZvaWQgMCA6IGNvbnRyb2xsZXIuYWJvcnQoKSk7XG4gICAgICAgIHZhbHVlT3JQcm9taXNlLnRoZW4oXG4gICAgICAgICAgbW91bnREZXBlbmRlbmNpZXNJZkFzeW5jLFxuICAgICAgICAgIG1vdW50RGVwZW5kZW5jaWVzSWZBc3luY1xuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGF0b21TdGF0ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZGVsZXRlIGF0b21TdGF0ZS52O1xuICAgICAgYXRvbVN0YXRlLmUgPSBlcnJvcjtcbiAgICAgICsrYXRvbVN0YXRlLm47XG4gICAgICByZXR1cm4gYXRvbVN0YXRlO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBpc1N5bmMgPSBmYWxzZTtcbiAgICAgIGlmIChwcmV2RXBvY2hOdW1iZXIgIT09IGF0b21TdGF0ZS5uICYmIGludmFsaWRhdGVkQXRvbXMuZ2V0KGF0b20pID09PSBwcmV2RXBvY2hOdW1iZXIpIHtcbiAgICAgICAgaW52YWxpZGF0ZWRBdG9tcy5zZXQoYXRvbSwgYXRvbVN0YXRlLm4pO1xuICAgICAgICBjaGFuZ2VkQXRvbXMuYWRkKGF0b20pO1xuICAgICAgICAoX2EgPSBzdG9yZUhvb2tzLmMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5jYWxsKHN0b3JlSG9va3MsIGF0b20pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGNvbnN0IGludmFsaWRhdGVEZXBlbmRlbnRzID0gYnVpbGRpbmdCbG9ja0Z1bmN0aW9uc1s0XSB8fCAoKGF0b20pID0+IHtcbiAgICBjb25zdCBzdGFjayA9IFthdG9tXTtcbiAgICB3aGlsZSAoc3RhY2subGVuZ3RoKSB7XG4gICAgICBjb25zdCBhID0gc3RhY2sucG9wKCk7XG4gICAgICBjb25zdCBhU3RhdGUgPSBlbnN1cmVBdG9tU3RhdGUoYSk7XG4gICAgICBmb3IgKGNvbnN0IGQgb2YgZ2V0TW91bnRlZE9yUGVuZGluZ0RlcGVuZGVudHMoYSwgYVN0YXRlLCBtb3VudGVkTWFwKSkge1xuICAgICAgICBjb25zdCBkU3RhdGUgPSBlbnN1cmVBdG9tU3RhdGUoZCk7XG4gICAgICAgIGludmFsaWRhdGVkQXRvbXMuc2V0KGQsIGRTdGF0ZS5uKTtcbiAgICAgICAgc3RhY2sucHVzaChkKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBjb25zdCB3cml0ZUF0b21TdGF0ZSA9IGJ1aWxkaW5nQmxvY2tGdW5jdGlvbnNbNV0gfHwgKChhdG9tLCAuLi5hcmdzKSA9PiB7XG4gICAgbGV0IGlzU3luYyA9IHRydWU7XG4gICAgY29uc3QgZ2V0dGVyID0gKGEpID0+IHJldHVybkF0b21WYWx1ZShyZWFkQXRvbVN0YXRlKGEpKTtcbiAgICBjb25zdCBzZXR0ZXIgPSAoYSwgLi4uYXJnczIpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIGNvbnN0IGFTdGF0ZSA9IGVuc3VyZUF0b21TdGF0ZShhKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChpc1NlbGZBdG9tKGF0b20sIGEpKSB7XG4gICAgICAgICAgaWYgKCFoYXNJbml0aWFsVmFsdWUoYSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImF0b20gbm90IHdyaXRhYmxlXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBwcmV2RXBvY2hOdW1iZXIgPSBhU3RhdGUubjtcbiAgICAgICAgICBjb25zdCB2ID0gYXJnczJbMF07XG4gICAgICAgICAgc2V0QXRvbVN0YXRlVmFsdWVPclByb21pc2UoYSwgdiwgZW5zdXJlQXRvbVN0YXRlKTtcbiAgICAgICAgICBtb3VudERlcGVuZGVuY2llcyhhKTtcbiAgICAgICAgICBpZiAocHJldkVwb2NoTnVtYmVyICE9PSBhU3RhdGUubikge1xuICAgICAgICAgICAgY2hhbmdlZEF0b21zLmFkZChhKTtcbiAgICAgICAgICAgIChfYSA9IHN0b3JlSG9va3MuYykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwoc3RvcmVIb29rcywgYSk7XG4gICAgICAgICAgICBpbnZhbGlkYXRlRGVwZW5kZW50cyhhKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHZvaWQgMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gd3JpdGVBdG9tU3RhdGUoYSwgLi4uYXJnczIpO1xuICAgICAgICB9XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBpZiAoIWlzU3luYykge1xuICAgICAgICAgIHJlY29tcHV0ZUludmFsaWRhdGVkQXRvbXMoKTtcbiAgICAgICAgICBmbHVzaENhbGxiYWNrcygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF0b21Xcml0ZShhdG9tLCBnZXR0ZXIsIHNldHRlciwgLi4uYXJncyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGlzU3luYyA9IGZhbHNlO1xuICAgIH1cbiAgfSk7XG4gIGNvbnN0IG1vdW50RGVwZW5kZW5jaWVzID0gYnVpbGRpbmdCbG9ja0Z1bmN0aW9uc1s2XSB8fCAoKGF0b20pID0+IHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgYXRvbVN0YXRlID0gZW5zdXJlQXRvbVN0YXRlKGF0b20pO1xuICAgIGNvbnN0IG1vdW50ZWQgPSBtb3VudGVkTWFwLmdldChhdG9tKTtcbiAgICBpZiAobW91bnRlZCAmJiAhaXNQZW5kaW5nUHJvbWlzZShhdG9tU3RhdGUudikpIHtcbiAgICAgIGZvciAoY29uc3QgW2EsIG5dIG9mIGF0b21TdGF0ZS5kKSB7XG4gICAgICAgIGlmICghbW91bnRlZC5kLmhhcyhhKSkge1xuICAgICAgICAgIGNvbnN0IGFTdGF0ZSA9IGVuc3VyZUF0b21TdGF0ZShhKTtcbiAgICAgICAgICBjb25zdCBhTW91bnRlZCA9IG1vdW50QXRvbShhKTtcbiAgICAgICAgICBhTW91bnRlZC50LmFkZChhdG9tKTtcbiAgICAgICAgICBtb3VudGVkLmQuYWRkKGEpO1xuICAgICAgICAgIGlmIChuICE9PSBhU3RhdGUubikge1xuICAgICAgICAgICAgY2hhbmdlZEF0b21zLmFkZChhKTtcbiAgICAgICAgICAgIChfYSA9IHN0b3JlSG9va3MuYykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwoc3RvcmVIb29rcywgYSk7XG4gICAgICAgICAgICBpbnZhbGlkYXRlRGVwZW5kZW50cyhhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZvciAoY29uc3QgYSBvZiBtb3VudGVkLmQgfHwgW10pIHtcbiAgICAgICAgaWYgKCFhdG9tU3RhdGUuZC5oYXMoYSkpIHtcbiAgICAgICAgICBtb3VudGVkLmQuZGVsZXRlKGEpO1xuICAgICAgICAgIGNvbnN0IGFNb3VudGVkID0gdW5tb3VudEF0b20oYSk7XG4gICAgICAgICAgYU1vdW50ZWQgPT0gbnVsbCA/IHZvaWQgMCA6IGFNb3VudGVkLnQuZGVsZXRlKGF0b20pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgY29uc3QgbW91bnRBdG9tID0gYnVpbGRpbmdCbG9ja0Z1bmN0aW9uc1s3XSB8fCAoKGF0b20pID0+IHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgYXRvbVN0YXRlID0gZW5zdXJlQXRvbVN0YXRlKGF0b20pO1xuICAgIGxldCBtb3VudGVkID0gbW91bnRlZE1hcC5nZXQoYXRvbSk7XG4gICAgaWYgKCFtb3VudGVkKSB7XG4gICAgICByZWFkQXRvbVN0YXRlKGF0b20pO1xuICAgICAgZm9yIChjb25zdCBhIG9mIGF0b21TdGF0ZS5kLmtleXMoKSkge1xuICAgICAgICBjb25zdCBhTW91bnRlZCA9IG1vdW50QXRvbShhKTtcbiAgICAgICAgYU1vdW50ZWQudC5hZGQoYXRvbSk7XG4gICAgICB9XG4gICAgICBtb3VudGVkID0ge1xuICAgICAgICBsOiAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpLFxuICAgICAgICBkOiBuZXcgU2V0KGF0b21TdGF0ZS5kLmtleXMoKSksXG4gICAgICAgIHQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KClcbiAgICAgIH07XG4gICAgICBtb3VudGVkTWFwLnNldChhdG9tLCBtb3VudGVkKTtcbiAgICAgIChfYSA9IHN0b3JlSG9va3MubSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwoc3RvcmVIb29rcywgYXRvbSk7XG4gICAgICBpZiAoaXNBY3R1YWxseVdyaXRhYmxlQXRvbShhdG9tKSkge1xuICAgICAgICBjb25zdCBwcm9jZXNzT25Nb3VudCA9ICgpID0+IHtcbiAgICAgICAgICBsZXQgaXNTeW5jID0gdHJ1ZTtcbiAgICAgICAgICBjb25zdCBzZXRBdG9tID0gKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHJldHVybiB3cml0ZUF0b21TdGF0ZShhdG9tLCAuLi5hcmdzKTtcbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgIGlmICghaXNTeW5jKSB7XG4gICAgICAgICAgICAgICAgcmVjb21wdXRlSW52YWxpZGF0ZWRBdG9tcygpO1xuICAgICAgICAgICAgICAgIGZsdXNoQ2FsbGJhY2tzKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBvblVubW91bnQgPSBhdG9tT25Nb3VudChhdG9tLCBzZXRBdG9tKTtcbiAgICAgICAgICAgIGlmIChvblVubW91bnQpIHtcbiAgICAgICAgICAgICAgbW91bnRlZC51ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlzU3luYyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIG9uVW5tb3VudCgpO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICBpc1N5bmMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGlzU3luYyA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgbW91bnRDYWxsYmFja3MuYWRkKHByb2Nlc3NPbk1vdW50KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1vdW50ZWQ7XG4gIH0pO1xuICBjb25zdCB1bm1vdW50QXRvbSA9IGJ1aWxkaW5nQmxvY2tGdW5jdGlvbnNbOF0gfHwgKChhdG9tKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IGF0b21TdGF0ZSA9IGVuc3VyZUF0b21TdGF0ZShhdG9tKTtcbiAgICBsZXQgbW91bnRlZCA9IG1vdW50ZWRNYXAuZ2V0KGF0b20pO1xuICAgIGlmIChtb3VudGVkICYmICFtb3VudGVkLmwuc2l6ZSAmJiAhQXJyYXkuZnJvbShtb3VudGVkLnQpLnNvbWUoKGEpID0+IHtcbiAgICAgIHZhciBfYTI7XG4gICAgICByZXR1cm4gKF9hMiA9IG1vdW50ZWRNYXAuZ2V0KGEpKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmQuaGFzKGF0b20pO1xuICAgIH0pKSB7XG4gICAgICBpZiAobW91bnRlZC51KSB7XG4gICAgICAgIHVubW91bnRDYWxsYmFja3MuYWRkKG1vdW50ZWQudSk7XG4gICAgICB9XG4gICAgICBtb3VudGVkID0gdm9pZCAwO1xuICAgICAgbW91bnRlZE1hcC5kZWxldGUoYXRvbSk7XG4gICAgICAoX2EgPSBzdG9yZUhvb2tzLnUpID09IG51bGwgPyB2b2lkIDAgOiBfYS5jYWxsKHN0b3JlSG9va3MsIGF0b20pO1xuICAgICAgZm9yIChjb25zdCBhIG9mIGF0b21TdGF0ZS5kLmtleXMoKSkge1xuICAgICAgICBjb25zdCBhTW91bnRlZCA9IHVubW91bnRBdG9tKGEpO1xuICAgICAgICBhTW91bnRlZCA9PSBudWxsID8gdm9pZCAwIDogYU1vdW50ZWQudC5kZWxldGUoYXRvbSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH1cbiAgICByZXR1cm4gbW91bnRlZDtcbiAgfSk7XG4gIGNvbnN0IGJ1aWxkaW5nQmxvY2tzID0gW1xuICAgIC8vIHN0b3JlIHN0YXRlXG4gICAgYXRvbVN0YXRlTWFwLFxuICAgIG1vdW50ZWRNYXAsXG4gICAgaW52YWxpZGF0ZWRBdG9tcyxcbiAgICBjaGFuZ2VkQXRvbXMsXG4gICAgbW91bnRDYWxsYmFja3MsXG4gICAgdW5tb3VudENhbGxiYWNrcyxcbiAgICBzdG9yZUhvb2tzLFxuICAgIC8vIGF0b20gaW50ZXJjZXB0b3JzXG4gICAgYXRvbVJlYWQsXG4gICAgYXRvbVdyaXRlLFxuICAgIGF0b21PbkluaXQsXG4gICAgYXRvbU9uTW91bnQsXG4gICAgLy8gYnVpbGRpbmctYmxvY2sgZnVuY3Rpb25zXG4gICAgZW5zdXJlQXRvbVN0YXRlLFxuICAgIGZsdXNoQ2FsbGJhY2tzLFxuICAgIHJlY29tcHV0ZUludmFsaWRhdGVkQXRvbXMsXG4gICAgcmVhZEF0b21TdGF0ZSxcbiAgICBpbnZhbGlkYXRlRGVwZW5kZW50cyxcbiAgICB3cml0ZUF0b21TdGF0ZSxcbiAgICBtb3VudERlcGVuZGVuY2llcyxcbiAgICBtb3VudEF0b20sXG4gICAgdW5tb3VudEF0b21cbiAgXTtcbiAgY29uc3Qgc3RvcmUgPSB7XG4gICAgZ2V0OiAoYXRvbSkgPT4gcmV0dXJuQXRvbVZhbHVlKHJlYWRBdG9tU3RhdGUoYXRvbSkpLFxuICAgIHNldDogKGF0b20sIC4uLmFyZ3MpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiB3cml0ZUF0b21TdGF0ZShhdG9tLCAuLi5hcmdzKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHJlY29tcHV0ZUludmFsaWRhdGVkQXRvbXMoKTtcbiAgICAgICAgZmx1c2hDYWxsYmFja3MoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHN1YjogKGF0b20sIGxpc3RlbmVyKSA9PiB7XG4gICAgICBjb25zdCBtb3VudGVkID0gbW91bnRBdG9tKGF0b20pO1xuICAgICAgY29uc3QgbGlzdGVuZXJzID0gbW91bnRlZC5sO1xuICAgICAgbGlzdGVuZXJzLmFkZChsaXN0ZW5lcik7XG4gICAgICBmbHVzaENhbGxiYWNrcygpO1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgbGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcik7XG4gICAgICAgIHVubW91bnRBdG9tKGF0b20pO1xuICAgICAgICBmbHVzaENhbGxiYWNrcygpO1xuICAgICAgfTtcbiAgICB9XG4gIH07XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdG9yZSwgQlVJTERJTkdfQkxPQ0tTLCB7IHZhbHVlOiBidWlsZGluZ0Jsb2NrcyB9KTtcbiAgcmV0dXJuIHN0b3JlO1xufTtcbmNvbnN0IElOVEVSTkFMX2J1aWxkU3RvcmVSZXYxID0gYnVpbGRTdG9yZTtcbmNvbnN0IElOVEVSTkFMX2dldEJ1aWxkaW5nQmxvY2tzUmV2MSA9IGdldEJ1aWxkaW5nQmxvY2tzO1xuY29uc3QgSU5URVJOQUxfaW5pdGlhbGl6ZVN0b3JlSG9va3MgPSBpbml0aWFsaXplU3RvcmVIb29rcztcbmNvbnN0IElOVEVSTkFMX2lzU2VsZkF0b20gPSBpc1NlbGZBdG9tO1xuY29uc3QgSU5URVJOQUxfaGFzSW5pdGlhbFZhbHVlID0gaGFzSW5pdGlhbFZhbHVlO1xuY29uc3QgSU5URVJOQUxfaXNBY3R1YWxseVdyaXRhYmxlQXRvbSA9IGlzQWN0dWFsbHlXcml0YWJsZUF0b207XG5jb25zdCBJTlRFUk5BTF9pc0F0b21TdGF0ZUluaXRpYWxpemVkID0gaXNBdG9tU3RhdGVJbml0aWFsaXplZDtcbmNvbnN0IElOVEVSTkFMX3JldHVybkF0b21WYWx1ZSA9IHJldHVybkF0b21WYWx1ZTtcbmNvbnN0IElOVEVSTkFMX3Byb21pc2VTdGF0ZU1hcCA9IHByb21pc2VTdGF0ZU1hcDtcbmNvbnN0IElOVEVSTkFMX2lzUGVuZGluZ1Byb21pc2UgPSBpc1BlbmRpbmdQcm9taXNlO1xuY29uc3QgSU5URVJOQUxfYWJvcnRQcm9taXNlID0gYWJvcnRQcm9taXNlO1xuY29uc3QgSU5URVJOQUxfcmVnaXN0ZXJBYm9ydEhhbmRsZXIgPSByZWdpc3RlckFib3J0SGFuZGxlcjtcbmNvbnN0IElOVEVSTkFMX2lzUHJvbWlzZUxpa2UgPSBpc1Byb21pc2VMaWtlO1xuY29uc3QgSU5URVJOQUxfYWRkUGVuZGluZ1Byb21pc2VUb0RlcGVuZGVuY3kgPSBhZGRQZW5kaW5nUHJvbWlzZVRvRGVwZW5kZW5jeTtcbmNvbnN0IElOVEVSTkFMX3NldEF0b21TdGF0ZVZhbHVlT3JQcm9taXNlID0gc2V0QXRvbVN0YXRlVmFsdWVPclByb21pc2U7XG5jb25zdCBJTlRFUk5BTF9nZXRNb3VudGVkT3JQZW5kaW5nRGVwZW5kZW50cyA9IGdldE1vdW50ZWRPclBlbmRpbmdEZXBlbmRlbnRzO1xuXG5leHBvcnQgeyBJTlRFUk5BTF9hYm9ydFByb21pc2UsIElOVEVSTkFMX2FkZFBlbmRpbmdQcm9taXNlVG9EZXBlbmRlbmN5LCBJTlRFUk5BTF9idWlsZFN0b3JlUmV2MSwgSU5URVJOQUxfZ2V0QnVpbGRpbmdCbG9ja3NSZXYxLCBJTlRFUk5BTF9nZXRNb3VudGVkT3JQZW5kaW5nRGVwZW5kZW50cywgSU5URVJOQUxfaGFzSW5pdGlhbFZhbHVlLCBJTlRFUk5BTF9pbml0aWFsaXplU3RvcmVIb29rcywgSU5URVJOQUxfaXNBY3R1YWxseVdyaXRhYmxlQXRvbSwgSU5URVJOQUxfaXNBdG9tU3RhdGVJbml0aWFsaXplZCwgSU5URVJOQUxfaXNQZW5kaW5nUHJvbWlzZSwgSU5URVJOQUxfaXNQcm9taXNlTGlrZSwgSU5URVJOQUxfaXNTZWxmQXRvbSwgSU5URVJOQUxfcHJvbWlzZVN0YXRlTWFwLCBJTlRFUk5BTF9yZWdpc3RlckFib3J0SGFuZGxlciwgSU5URVJOQUxfcmV0dXJuQXRvbVZhbHVlLCBJTlRFUk5BTF9zZXRBdG9tU3RhdGVWYWx1ZU9yUHJvbWlzZSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/internals.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/utils.mjs":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/utils.mjs ***!
  \********************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RESET: () => (/* binding */ RESET),\n/* harmony export */   atomFamily: () => (/* binding */ atomFamily),\n/* harmony export */   atomWithDefault: () => (/* binding */ atomWithDefault),\n/* harmony export */   atomWithLazy: () => (/* binding */ atomWithLazy),\n/* harmony export */   atomWithObservable: () => (/* binding */ atomWithObservable),\n/* harmony export */   atomWithReducer: () => (/* binding */ atomWithReducer),\n/* harmony export */   atomWithRefresh: () => (/* binding */ atomWithRefresh),\n/* harmony export */   atomWithReset: () => (/* binding */ atomWithReset),\n/* harmony export */   atomWithStorage: () => (/* binding */ atomWithStorage),\n/* harmony export */   createJSONStorage: () => (/* binding */ createJSONStorage),\n/* harmony export */   freezeAtom: () => (/* binding */ freezeAtom),\n/* harmony export */   freezeAtomCreator: () => (/* binding */ freezeAtomCreator),\n/* harmony export */   loadable: () => (/* binding */ loadable),\n/* harmony export */   selectAtom: () => (/* binding */ selectAtom),\n/* harmony export */   splitAtom: () => (/* binding */ splitAtom),\n/* harmony export */   unstable_withStorageValidator: () => (/* binding */ withStorageValidator),\n/* harmony export */   unwrap: () => (/* binding */ unwrap)\n/* harmony export */ });\n/* harmony import */ var jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jotai/vanilla */ \"(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla.mjs\");\n\n\nconst RESET = Symbol(\n  ( false ? 0 : void 0) !== \"production\" ? \"RESET\" : \"\"\n);\n\nfunction atomWithReset(initialValue) {\n  const anAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n    initialValue,\n    (get, set, update) => {\n      const nextValue = typeof update === \"function\" ? update(get(anAtom)) : update;\n      set(anAtom, nextValue === RESET ? initialValue : nextValue);\n    }\n  );\n  return anAtom;\n}\n\nfunction atomWithReducer(initialValue, reducer) {\n  return (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(initialValue, function(get, set, action) {\n    set(this, reducer(get(this), action));\n  });\n}\n\nfunction atomFamily(initializeAtom, areEqual) {\n  let shouldRemove = null;\n  const atoms = /* @__PURE__ */ new Map();\n  const listeners = /* @__PURE__ */ new Set();\n  const createAtom = (param) => {\n    let item;\n    if (areEqual === void 0) {\n      item = atoms.get(param);\n    } else {\n      for (const [key, value] of atoms) {\n        if (areEqual(key, param)) {\n          item = value;\n          break;\n        }\n      }\n    }\n    if (item !== void 0) {\n      if (shouldRemove == null ? void 0 : shouldRemove(item[1], param)) {\n        createAtom.remove(param);\n      } else {\n        return item[0];\n      }\n    }\n    const newAtom = initializeAtom(param);\n    atoms.set(param, [newAtom, Date.now()]);\n    notifyListeners(\"CREATE\", param, newAtom);\n    return newAtom;\n  };\n  const notifyListeners = (type, param, atom) => {\n    for (const listener of listeners) {\n      listener({ type, param, atom });\n    }\n  };\n  createAtom.unstable_listen = (callback) => {\n    listeners.add(callback);\n    return () => {\n      listeners.delete(callback);\n    };\n  };\n  createAtom.getParams = () => atoms.keys();\n  createAtom.remove = (param) => {\n    if (areEqual === void 0) {\n      if (!atoms.has(param)) return;\n      const [atom] = atoms.get(param);\n      atoms.delete(param);\n      notifyListeners(\"REMOVE\", param, atom);\n    } else {\n      for (const [key, [atom]] of atoms) {\n        if (areEqual(key, param)) {\n          atoms.delete(key);\n          notifyListeners(\"REMOVE\", key, atom);\n          break;\n        }\n      }\n    }\n  };\n  createAtom.setShouldRemove = (fn) => {\n    shouldRemove = fn;\n    if (!shouldRemove) return;\n    for (const [key, [atom, createdAt]] of atoms) {\n      if (shouldRemove(createdAt, key)) {\n        atoms.delete(key);\n        notifyListeners(\"REMOVE\", key, atom);\n      }\n    }\n  };\n  return createAtom;\n}\n\nconst getCached$2 = (c, m, k) => (m.has(k) ? m : m.set(k, c())).get(k);\nconst cache1$3 = /* @__PURE__ */ new WeakMap();\nconst memo3 = (create, dep1, dep2, dep3) => {\n  const cache2 = getCached$2(() => /* @__PURE__ */ new WeakMap(), cache1$3, dep1);\n  const cache3 = getCached$2(() => /* @__PURE__ */ new WeakMap(), cache2, dep2);\n  return getCached$2(create, cache3, dep3);\n};\nfunction selectAtom(anAtom, selector, equalityFn = Object.is) {\n  return memo3(\n    () => {\n      const EMPTY = Symbol();\n      const selectValue = ([value, prevSlice]) => {\n        if (prevSlice === EMPTY) {\n          return selector(value);\n        }\n        const slice = selector(value, prevSlice);\n        return equalityFn(prevSlice, slice) ? prevSlice : slice;\n      };\n      const derivedAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)((get) => {\n        const prev = get(derivedAtom);\n        const value = get(anAtom);\n        return selectValue([value, prev]);\n      });\n      derivedAtom.init = EMPTY;\n      return derivedAtom;\n    },\n    anAtom,\n    selector,\n    equalityFn\n  );\n}\n\nconst frozenAtoms = /* @__PURE__ */ new WeakSet();\nconst deepFreeze = (value) => {\n  if (typeof value !== \"object\" || value === null) {\n    return value;\n  }\n  Object.freeze(value);\n  const propNames = Object.getOwnPropertyNames(value);\n  for (const name of propNames) {\n    deepFreeze(value[name]);\n  }\n  return value;\n};\nfunction freezeAtom(anAtom) {\n  if (frozenAtoms.has(anAtom)) {\n    return anAtom;\n  }\n  frozenAtoms.add(anAtom);\n  const origRead = anAtom.read;\n  anAtom.read = function(get, options) {\n    return deepFreeze(origRead.call(this, get, options));\n  };\n  if (\"write\" in anAtom) {\n    const origWrite = anAtom.write;\n    anAtom.write = function(get, set, ...args) {\n      return origWrite.call(\n        this,\n        get,\n        (...setArgs) => {\n          if (setArgs[0] === anAtom) {\n            setArgs[1] = deepFreeze(setArgs[1]);\n          }\n          return set(...setArgs);\n        },\n        ...args\n      );\n    };\n  }\n  return anAtom;\n}\nfunction freezeAtomCreator(createAtom) {\n  if (( false ? 0 : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] freezeAtomCreator is deprecated, define it on users end\"\n    );\n  }\n  return (...args) => freezeAtom(createAtom(...args));\n}\n\nconst getCached$1 = (c, m, k) => (m.has(k) ? m : m.set(k, c())).get(k);\nconst cache1$2 = /* @__PURE__ */ new WeakMap();\nconst memo2$1 = (create, dep1, dep2) => {\n  const cache2 = getCached$1(() => /* @__PURE__ */ new WeakMap(), cache1$2, dep1);\n  return getCached$1(create, cache2, dep2);\n};\nconst cacheKeyForEmptyKeyExtractor = {};\nconst isWritable = (atom2) => !!atom2.write;\nconst isFunction = (x) => typeof x === \"function\";\nfunction splitAtom(arrAtom, keyExtractor) {\n  return memo2$1(\n    () => {\n      const mappingCache = /* @__PURE__ */ new WeakMap();\n      const getMapping = (arr, prev) => {\n        let mapping = mappingCache.get(arr);\n        if (mapping) {\n          return mapping;\n        }\n        const prevMapping = prev && mappingCache.get(prev);\n        const atomList = [];\n        const keyList = [];\n        arr.forEach((item, index) => {\n          const key = keyExtractor ? keyExtractor(item) : index;\n          keyList[index] = key;\n          const cachedAtom = prevMapping && prevMapping.atomList[prevMapping.keyList.indexOf(key)];\n          if (cachedAtom) {\n            atomList[index] = cachedAtom;\n            return;\n          }\n          const read = (get) => {\n            const prev2 = get(mappingAtom);\n            const currArr = get(arrAtom);\n            const mapping2 = getMapping(currArr, prev2 == null ? void 0 : prev2.arr);\n            const index2 = mapping2.keyList.indexOf(key);\n            if (index2 < 0 || index2 >= currArr.length) {\n              const prevItem = arr[getMapping(arr).keyList.indexOf(key)];\n              if (prevItem) {\n                return prevItem;\n              }\n              throw new Error(\"splitAtom: index out of bounds for read\");\n            }\n            return currArr[index2];\n          };\n          const write = (get, set, update) => {\n            const prev2 = get(mappingAtom);\n            const arr2 = get(arrAtom);\n            const mapping2 = getMapping(arr2, prev2 == null ? void 0 : prev2.arr);\n            const index2 = mapping2.keyList.indexOf(key);\n            if (index2 < 0 || index2 >= arr2.length) {\n              throw new Error(\"splitAtom: index out of bounds for write\");\n            }\n            const nextItem = isFunction(update) ? update(arr2[index2]) : update;\n            if (!Object.is(arr2[index2], nextItem)) {\n              set(arrAtom, [\n                ...arr2.slice(0, index2),\n                nextItem,\n                ...arr2.slice(index2 + 1)\n              ]);\n            }\n          };\n          atomList[index] = isWritable(arrAtom) ? (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(read, write) : (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(read);\n        });\n        if (prevMapping && prevMapping.keyList.length === keyList.length && prevMapping.keyList.every((x, i) => x === keyList[i])) {\n          mapping = prevMapping;\n        } else {\n          mapping = { arr, atomList, keyList };\n        }\n        mappingCache.set(arr, mapping);\n        return mapping;\n      };\n      const mappingAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)((get) => {\n        const prev = get(mappingAtom);\n        const arr = get(arrAtom);\n        const mapping = getMapping(arr, prev == null ? void 0 : prev.arr);\n        return mapping;\n      });\n      if (( false ? 0 : void 0) !== \"production\") {\n        mappingAtom.debugPrivate = true;\n      }\n      mappingAtom.init = void 0;\n      const splittedAtom = isWritable(arrAtom) ? (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n        (get) => get(mappingAtom).atomList,\n        (get, set, action) => {\n          switch (action.type) {\n            case \"remove\": {\n              const index = get(splittedAtom).indexOf(action.atom);\n              if (index >= 0) {\n                const arr = get(arrAtom);\n                set(arrAtom, [\n                  ...arr.slice(0, index),\n                  ...arr.slice(index + 1)\n                ]);\n              }\n              break;\n            }\n            case \"insert\": {\n              const index = action.before ? get(splittedAtom).indexOf(action.before) : get(splittedAtom).length;\n              if (index >= 0) {\n                const arr = get(arrAtom);\n                set(arrAtom, [\n                  ...arr.slice(0, index),\n                  action.value,\n                  ...arr.slice(index)\n                ]);\n              }\n              break;\n            }\n            case \"move\": {\n              const index1 = get(splittedAtom).indexOf(action.atom);\n              const index2 = action.before ? get(splittedAtom).indexOf(action.before) : get(splittedAtom).length;\n              if (index1 >= 0 && index2 >= 0) {\n                const arr = get(arrAtom);\n                if (index1 < index2) {\n                  set(arrAtom, [\n                    ...arr.slice(0, index1),\n                    ...arr.slice(index1 + 1, index2),\n                    arr[index1],\n                    ...arr.slice(index2)\n                  ]);\n                } else {\n                  set(arrAtom, [\n                    ...arr.slice(0, index2),\n                    arr[index1],\n                    ...arr.slice(index2, index1),\n                    ...arr.slice(index1 + 1)\n                  ]);\n                }\n              }\n              break;\n            }\n          }\n        }\n      ) : (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)((get) => get(mappingAtom).atomList);\n      return splittedAtom;\n    },\n    arrAtom,\n    keyExtractor || cacheKeyForEmptyKeyExtractor\n  );\n}\n\nfunction atomWithDefault(getDefault) {\n  const EMPTY = Symbol();\n  const overwrittenAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(EMPTY);\n  if (( false ? 0 : void 0) !== \"production\") {\n    overwrittenAtom.debugPrivate = true;\n  }\n  const anAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n    (get, options) => {\n      const overwritten = get(overwrittenAtom);\n      if (overwritten !== EMPTY) {\n        return overwritten;\n      }\n      return getDefault(get, options);\n    },\n    (get, set, update) => {\n      if (update === RESET) {\n        set(overwrittenAtom, EMPTY);\n      } else if (typeof update === \"function\") {\n        const prevValue = get(anAtom);\n        set(overwrittenAtom, update(prevValue));\n      } else {\n        set(overwrittenAtom, update);\n      }\n    }\n  );\n  return anAtom;\n}\n\nconst isPromiseLike$3 = (x) => typeof (x == null ? void 0 : x.then) === \"function\";\nfunction withStorageValidator(validator) {\n  return (unknownStorage) => {\n    const storage = {\n      ...unknownStorage,\n      getItem: (key, initialValue) => {\n        const validate = (value2) => {\n          if (!validator(value2)) {\n            return initialValue;\n          }\n          return value2;\n        };\n        const value = unknownStorage.getItem(key, initialValue);\n        if (isPromiseLike$3(value)) {\n          return value.then(validate);\n        }\n        return validate(value);\n      }\n    };\n    return storage;\n  };\n}\nfunction createJSONStorage(getStringStorage = () => {\n  try {\n    return window.localStorage;\n  } catch (e) {\n    if (( false ? 0 : void 0) !== \"production\") {\n      if (typeof window !== \"undefined\") {\n        console.warn(e);\n      }\n    }\n    return void 0;\n  }\n}, options) {\n  var _a;\n  let lastStr;\n  let lastValue;\n  const storage = {\n    getItem: (key, initialValue) => {\n      var _a2, _b;\n      const parse = (str2) => {\n        str2 = str2 || \"\";\n        if (lastStr !== str2) {\n          try {\n            lastValue = JSON.parse(str2, options == null ? void 0 : options.reviver);\n          } catch (e) {\n            return initialValue;\n          }\n          lastStr = str2;\n        }\n        return lastValue;\n      };\n      const str = (_b = (_a2 = getStringStorage()) == null ? void 0 : _a2.getItem(key)) != null ? _b : null;\n      if (isPromiseLike$3(str)) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (key, newValue) => {\n      var _a2;\n      return (_a2 = getStringStorage()) == null ? void 0 : _a2.setItem(\n        key,\n        JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n      );\n    },\n    removeItem: (key) => {\n      var _a2;\n      return (_a2 = getStringStorage()) == null ? void 0 : _a2.removeItem(key);\n    }\n  };\n  const createHandleSubscribe = (subscriber2) => (key, callback, initialValue) => subscriber2(key, (v) => {\n    let newValue;\n    try {\n      newValue = JSON.parse(v || \"\");\n    } catch (e) {\n      newValue = initialValue;\n    }\n    callback(newValue);\n  });\n  let subscriber;\n  try {\n    subscriber = (_a = getStringStorage()) == null ? void 0 : _a.subscribe;\n  } catch (e) {\n  }\n  if (!subscriber && typeof window !== \"undefined\" && typeof window.addEventListener === \"function\" && window.Storage) {\n    subscriber = (key, callback) => {\n      if (!(getStringStorage() instanceof window.Storage)) {\n        return () => {\n        };\n      }\n      const storageEventCallback = (e) => {\n        if (e.storageArea === getStringStorage() && e.key === key) {\n          callback(e.newValue);\n        }\n      };\n      window.addEventListener(\"storage\", storageEventCallback);\n      return () => {\n        window.removeEventListener(\"storage\", storageEventCallback);\n      };\n    };\n  }\n  if (subscriber) {\n    storage.subscribe = createHandleSubscribe(subscriber);\n  }\n  return storage;\n}\nconst defaultStorage = createJSONStorage();\nfunction atomWithStorage(key, initialValue, storage = defaultStorage, options) {\n  const getOnInit = options == null ? void 0 : options.getOnInit;\n  const baseAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n    getOnInit ? storage.getItem(key, initialValue) : initialValue\n  );\n  if (( false ? 0 : void 0) !== \"production\") {\n    baseAtom.debugPrivate = true;\n  }\n  baseAtom.onMount = (setAtom) => {\n    setAtom(storage.getItem(key, initialValue));\n    let unsub;\n    if (storage.subscribe) {\n      unsub = storage.subscribe(key, setAtom, initialValue);\n    }\n    return unsub;\n  };\n  const anAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n    (get) => get(baseAtom),\n    (get, set, update) => {\n      const nextValue = typeof update === \"function\" ? update(get(baseAtom)) : update;\n      if (nextValue === RESET) {\n        set(baseAtom, initialValue);\n        return storage.removeItem(key);\n      }\n      if (isPromiseLike$3(nextValue)) {\n        return nextValue.then((resolvedValue) => {\n          set(baseAtom, resolvedValue);\n          return storage.setItem(key, resolvedValue);\n        });\n      }\n      set(baseAtom, nextValue);\n      return storage.setItem(key, nextValue);\n    }\n  );\n  return anAtom;\n}\n\nconst isPromiseLike$2 = (x) => typeof (x == null ? void 0 : x.then) === \"function\";\nfunction atomWithObservable(getObservable, options) {\n  const returnResultData = (result) => {\n    if (\"e\" in result) {\n      throw result.e;\n    }\n    return result.d;\n  };\n  const observableResultAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)((get) => {\n    var _a;\n    let observable = getObservable(get);\n    const itself = (_a = observable[Symbol.observable]) == null ? void 0 : _a.call(observable);\n    if (itself) {\n      observable = itself;\n    }\n    let resolve;\n    const makePending = () => new Promise((r) => {\n      resolve = r;\n    });\n    const initialResult = options && \"initialValue\" in options ? {\n      d: typeof options.initialValue === \"function\" ? options.initialValue() : options.initialValue\n    } : makePending();\n    let setResult;\n    let lastResult;\n    const listener = (result) => {\n      lastResult = result;\n      resolve == null ? void 0 : resolve(result);\n      setResult == null ? void 0 : setResult(result);\n    };\n    let subscription;\n    let timer;\n    const isNotMounted = () => !setResult;\n    const unsubscribe = () => {\n      if (subscription) {\n        subscription.unsubscribe();\n        subscription = void 0;\n      }\n    };\n    const start = () => {\n      if (subscription) {\n        clearTimeout(timer);\n        subscription.unsubscribe();\n      }\n      subscription = observable.subscribe({\n        next: (d) => listener({ d }),\n        error: (e) => listener({ e }),\n        complete: () => {\n        }\n      });\n      if (isNotMounted() && (options == null ? void 0 : options.unstable_timeout)) {\n        timer = setTimeout(unsubscribe, options.unstable_timeout);\n      }\n    };\n    start();\n    const resultAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(lastResult || initialResult);\n    if (( false ? 0 : void 0) !== \"production\") {\n      resultAtom.debugPrivate = true;\n    }\n    resultAtom.onMount = (update) => {\n      setResult = update;\n      if (lastResult) {\n        update(lastResult);\n      }\n      if (subscription) {\n        clearTimeout(timer);\n      } else {\n        start();\n      }\n      return () => {\n        setResult = void 0;\n        if (options == null ? void 0 : options.unstable_timeout) {\n          timer = setTimeout(unsubscribe, options.unstable_timeout);\n        } else {\n          unsubscribe();\n        }\n      };\n    };\n    return [resultAtom, observable, makePending, start, isNotMounted];\n  });\n  if (( false ? 0 : void 0) !== \"production\") {\n    observableResultAtom.debugPrivate = true;\n  }\n  const observableAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n    (get) => {\n      const [resultAtom] = get(observableResultAtom);\n      const result = get(resultAtom);\n      if (isPromiseLike$2(result)) {\n        return result.then(returnResultData);\n      }\n      return returnResultData(result);\n    },\n    (get, set, data) => {\n      const [resultAtom, observable, makePending, start, isNotMounted] = get(observableResultAtom);\n      if (\"next\" in observable) {\n        if (isNotMounted()) {\n          set(resultAtom, makePending());\n          start();\n        }\n        observable.next(data);\n      } else {\n        throw new Error(\"observable is not subject\");\n      }\n    }\n  );\n  return observableAtom;\n}\n\nconst cache1$1 = /* @__PURE__ */ new WeakMap();\nconst memo1 = (create, dep1) => (cache1$1.has(dep1) ? cache1$1 : cache1$1.set(dep1, create())).get(dep1);\nconst isPromiseLike$1 = (p) => typeof (p == null ? void 0 : p.then) === \"function\";\nconst LOADING = { state: \"loading\" };\nfunction loadable(anAtom) {\n  return memo1(() => {\n    const loadableCache = /* @__PURE__ */ new WeakMap();\n    const refreshAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(0);\n    if (( false ? 0 : void 0) !== \"production\") {\n      refreshAtom.debugPrivate = true;\n    }\n    const derivedAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n      (get, { setSelf }) => {\n        get(refreshAtom);\n        let value;\n        try {\n          value = get(anAtom);\n        } catch (error) {\n          return { state: \"hasError\", error };\n        }\n        if (!isPromiseLike$1(value)) {\n          return { state: \"hasData\", data: value };\n        }\n        const promise = value;\n        const cached1 = loadableCache.get(promise);\n        if (cached1) {\n          return cached1;\n        }\n        promise.then(\n          (data) => {\n            loadableCache.set(promise, { state: \"hasData\", data });\n            setSelf();\n          },\n          (error) => {\n            loadableCache.set(promise, { state: \"hasError\", error });\n            setSelf();\n          }\n        );\n        const cached2 = loadableCache.get(promise);\n        if (cached2) {\n          return cached2;\n        }\n        loadableCache.set(promise, LOADING);\n        return LOADING;\n      },\n      (_get, set) => {\n        set(refreshAtom, (c) => c + 1);\n      }\n    );\n    if (( false ? 0 : void 0) !== \"production\") {\n      derivedAtom.debugPrivate = true;\n    }\n    return (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)((get) => get(derivedAtom));\n  }, anAtom);\n}\n\nconst getCached = (c, m, k) => (m.has(k) ? m : m.set(k, c())).get(k);\nconst cache1 = /* @__PURE__ */ new WeakMap();\nconst memo2 = (create, dep1, dep2) => {\n  const cache2 = getCached(() => /* @__PURE__ */ new WeakMap(), cache1, dep1);\n  return getCached(create, cache2, dep2);\n};\nconst isPromiseLike = (p) => typeof (p == null ? void 0 : p.then) === \"function\";\nconst defaultFallback = () => void 0;\nfunction unwrap(anAtom, fallback = defaultFallback) {\n  return memo2(\n    () => {\n      const promiseErrorCache = /* @__PURE__ */ new WeakMap();\n      const promiseResultCache = /* @__PURE__ */ new WeakMap();\n      const refreshAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(0);\n      if (( false ? 0 : void 0) !== \"production\") {\n        refreshAtom.debugPrivate = true;\n      }\n      const promiseAndValueAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n        (get, { setSelf }) => {\n          get(refreshAtom);\n          const prev = get(promiseAndValueAtom);\n          const promise = get(anAtom);\n          if (!isPromiseLike(promise)) {\n            return { v: promise };\n          }\n          if (promise !== (prev == null ? void 0 : prev.p)) {\n            promise.then(\n              (v) => {\n                promiseResultCache.set(promise, v);\n                setSelf();\n              },\n              (e) => {\n                promiseErrorCache.set(promise, e);\n                setSelf();\n              }\n            );\n          }\n          if (promiseErrorCache.has(promise)) {\n            throw promiseErrorCache.get(promise);\n          }\n          if (promiseResultCache.has(promise)) {\n            return {\n              p: promise,\n              v: promiseResultCache.get(promise)\n            };\n          }\n          if (prev && \"v\" in prev) {\n            return { p: promise, f: fallback(prev.v), v: prev.v };\n          }\n          return { p: promise, f: fallback() };\n        },\n        (_get, set) => {\n          set(refreshAtom, (c) => c + 1);\n        }\n      );\n      promiseAndValueAtom.init = void 0;\n      if (( false ? 0 : void 0) !== \"production\") {\n        promiseAndValueAtom.debugPrivate = true;\n      }\n      return (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n        (get) => {\n          const state = get(promiseAndValueAtom);\n          if (\"f\" in state) {\n            return state.f;\n          }\n          return state.v;\n        },\n        (_get, set, ...args) => set(anAtom, ...args)\n      );\n    },\n    anAtom,\n    fallback\n  );\n}\n\nfunction atomWithRefresh(read, write) {\n  const refreshAtom = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(0);\n  if (( false ? 0 : void 0) !== \"production\") {\n    refreshAtom.debugPrivate = true;\n  }\n  return (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(\n    (get, options) => {\n      get(refreshAtom);\n      return read(get, options);\n    },\n    (get, set, ...args) => {\n      if (args.length === 0) {\n        set(refreshAtom, (c) => c + 1);\n      } else if (write) {\n        return write(get, set, ...args);\n      } else if (( false ? 0 : void 0) !== \"production\") {\n        throw new Error(\"refresh must be called without arguments\");\n      }\n    }\n  );\n}\n\nfunction atomWithLazy(makeInitial) {\n  const a = (0,jotai_vanilla__WEBPACK_IMPORTED_MODULE_0__.atom)(void 0);\n  delete a.init;\n  Object.defineProperty(a, \"init\", {\n    get() {\n      return makeInitial();\n    }\n  });\n  return a;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vam90YWlAMi4xMi41X0B0eXBlcytyZWFjdEAxOC4zLjIzX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvam90YWkvZXNtL3ZhbmlsbGEvdXRpbHMubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxQzs7QUFFckM7QUFDQSxHQUFHLE1BQWUsR0FBRyxDQUFvQjtBQUN6Qzs7QUFFQTtBQUNBLGlCQUFpQixtREFBSTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUyxtREFBSTtBQUNiO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsbUJBQW1CO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLG1EQUFJO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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V0FBVyxNQUFlLEdBQUcsQ0FBb0I7QUFDakQ7QUFDQTtBQUNBLGFBQWEsbURBQUk7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxzQkFBc0IsbURBQUk7QUFDMUIsT0FBTyxNQUFlLEdBQUcsQ0FBb0I7QUFDN0M7QUFDQTtBQUNBLFNBQVMsbURBQUk7QUFDYjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUSxVQUFVLE1BQWUsR0FBRyxDQUFvQjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSxtREFBSTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRW9TIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZG90dWkvLi9ub2RlX21vZHVsZXMvLnBucG0vam90YWlAMi4xMi41X0B0eXBlcytyZWFjdEAxOC4zLjIzX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvam90YWkvZXNtL3ZhbmlsbGEvdXRpbHMubWpzP2JlNjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXRvbSB9IGZyb20gJ2pvdGFpL3ZhbmlsbGEnO1xuXG5jb25zdCBSRVNFVCA9IFN5bWJvbChcbiAgKGltcG9ydC5tZXRhLmVudiA/IGltcG9ydC5tZXRhLmVudi5NT0RFIDogdm9pZCAwKSAhPT0gXCJwcm9kdWN0aW9uXCIgPyBcIlJFU0VUXCIgOiBcIlwiXG4pO1xuXG5mdW5jdGlvbiBhdG9tV2l0aFJlc2V0KGluaXRpYWxWYWx1ZSkge1xuICBjb25zdCBhbkF0b20gPSBhdG9tKFxuICAgIGluaXRpYWxWYWx1ZSxcbiAgICAoZ2V0LCBzZXQsIHVwZGF0ZSkgPT4ge1xuICAgICAgY29uc3QgbmV4dFZhbHVlID0gdHlwZW9mIHVwZGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gdXBkYXRlKGdldChhbkF0b20pKSA6IHVwZGF0ZTtcbiAgICAgIHNldChhbkF0b20sIG5leHRWYWx1ZSA9PT0gUkVTRVQgPyBpbml0aWFsVmFsdWUgOiBuZXh0VmFsdWUpO1xuICAgIH1cbiAgKTtcbiAgcmV0dXJuIGFuQXRvbTtcbn1cblxuZnVuY3Rpb24gYXRvbVdpdGhSZWR1Y2VyKGluaXRpYWxWYWx1ZSwgcmVkdWNlcikge1xuICByZXR1cm4gYXRvbShpbml0aWFsVmFsdWUsIGZ1bmN0aW9uKGdldCwgc2V0LCBhY3Rpb24pIHtcbiAgICBzZXQodGhpcywgcmVkdWNlcihnZXQodGhpcyksIGFjdGlvbikpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gYXRvbUZhbWlseShpbml0aWFsaXplQXRvbSwgYXJlRXF1YWwpIHtcbiAgbGV0IHNob3VsZFJlbW92ZSA9IG51bGw7XG4gIGNvbnN0IGF0b21zID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgY29uc3QgbGlzdGVuZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgY29uc3QgY3JlYXRlQXRvbSA9IChwYXJhbSkgPT4ge1xuICAgIGxldCBpdGVtO1xuICAgIGlmIChhcmVFcXVhbCA9PT0gdm9pZCAwKSB7XG4gICAgICBpdGVtID0gYXRvbXMuZ2V0KHBhcmFtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgYXRvbXMpIHtcbiAgICAgICAgaWYgKGFyZUVxdWFsKGtleSwgcGFyYW0pKSB7XG4gICAgICAgICAgaXRlbSA9IHZhbHVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChpdGVtICE9PSB2b2lkIDApIHtcbiAgICAgIGlmIChzaG91bGRSZW1vdmUgPT0gbnVsbCA/IHZvaWQgMCA6IHNob3VsZFJlbW92ZShpdGVtWzFdLCBwYXJhbSkpIHtcbiAgICAgICAgY3JlYXRlQXRvbS5yZW1vdmUocGFyYW0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF07XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5ld0F0b20gPSBpbml0aWFsaXplQXRvbShwYXJhbSk7XG4gICAgYXRvbXMuc2V0KHBhcmFtLCBbbmV3QXRvbSwgRGF0ZS5ub3coKV0pO1xuICAgIG5vdGlmeUxpc3RlbmVycyhcIkNSRUFURVwiLCBwYXJhbSwgbmV3QXRvbSk7XG4gICAgcmV0dXJuIG5ld0F0b207XG4gIH07XG4gIGNvbnN0IG5vdGlmeUxpc3RlbmVycyA9ICh0eXBlLCBwYXJhbSwgYXRvbSkgPT4ge1xuICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgbGlzdGVuZXJzKSB7XG4gICAgICBsaXN0ZW5lcih7IHR5cGUsIHBhcmFtLCBhdG9tIH0pO1xuICAgIH1cbiAgfTtcbiAgY3JlYXRlQXRvbS51bnN0YWJsZV9saXN0ZW4gPSAoY2FsbGJhY2spID0+IHtcbiAgICBsaXN0ZW5lcnMuYWRkKGNhbGxiYWNrKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbGlzdGVuZXJzLmRlbGV0ZShjYWxsYmFjayk7XG4gICAgfTtcbiAgfTtcbiAgY3JlYXRlQXRvbS5nZXRQYXJhbXMgPSAoKSA9PiBhdG9tcy5rZXlzKCk7XG4gIGNyZWF0ZUF0b20ucmVtb3ZlID0gKHBhcmFtKSA9PiB7XG4gICAgaWYgKGFyZUVxdWFsID09PSB2b2lkIDApIHtcbiAgICAgIGlmICghYXRvbXMuaGFzKHBhcmFtKSkgcmV0dXJuO1xuICAgICAgY29uc3QgW2F0b21dID0gYXRvbXMuZ2V0KHBhcmFtKTtcbiAgICAgIGF0b21zLmRlbGV0ZShwYXJhbSk7XG4gICAgICBub3RpZnlMaXN0ZW5lcnMoXCJSRU1PVkVcIiwgcGFyYW0sIGF0b20pO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIFthdG9tXV0gb2YgYXRvbXMpIHtcbiAgICAgICAgaWYgKGFyZUVxdWFsKGtleSwgcGFyYW0pKSB7XG4gICAgICAgICAgYXRvbXMuZGVsZXRlKGtleSk7XG4gICAgICAgICAgbm90aWZ5TGlzdGVuZXJzKFwiUkVNT1ZFXCIsIGtleSwgYXRvbSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIGNyZWF0ZUF0b20uc2V0U2hvdWxkUmVtb3ZlID0gKGZuKSA9PiB7XG4gICAgc2hvdWxkUmVtb3ZlID0gZm47XG4gICAgaWYgKCFzaG91bGRSZW1vdmUpIHJldHVybjtcbiAgICBmb3IgKGNvbnN0IFtrZXksIFthdG9tLCBjcmVhdGVkQXRdXSBvZiBhdG9tcykge1xuICAgICAgaWYgKHNob3VsZFJlbW92ZShjcmVhdGVkQXQsIGtleSkpIHtcbiAgICAgICAgYXRvbXMuZGVsZXRlKGtleSk7XG4gICAgICAgIG5vdGlmeUxpc3RlbmVycyhcIlJFTU9WRVwiLCBrZXksIGF0b20pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgcmV0dXJuIGNyZWF0ZUF0b207XG59XG5cbmNvbnN0IGdldENhY2hlZCQyID0gKGMsIG0sIGspID0+IChtLmhhcyhrKSA/IG0gOiBtLnNldChrLCBjKCkpKS5nZXQoayk7XG5jb25zdCBjYWNoZTEkMyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpO1xuY29uc3QgbWVtbzMgPSAoY3JlYXRlLCBkZXAxLCBkZXAyLCBkZXAzKSA9PiB7XG4gIGNvbnN0IGNhY2hlMiA9IGdldENhY2hlZCQyKCgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpLCBjYWNoZTEkMywgZGVwMSk7XG4gIGNvbnN0IGNhY2hlMyA9IGdldENhY2hlZCQyKCgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpLCBjYWNoZTIsIGRlcDIpO1xuICByZXR1cm4gZ2V0Q2FjaGVkJDIoY3JlYXRlLCBjYWNoZTMsIGRlcDMpO1xufTtcbmZ1bmN0aW9uIHNlbGVjdEF0b20oYW5BdG9tLCBzZWxlY3RvciwgZXF1YWxpdHlGbiA9IE9iamVjdC5pcykge1xuICByZXR1cm4gbWVtbzMoXG4gICAgKCkgPT4ge1xuICAgICAgY29uc3QgRU1QVFkgPSBTeW1ib2woKTtcbiAgICAgIGNvbnN0IHNlbGVjdFZhbHVlID0gKFt2YWx1ZSwgcHJldlNsaWNlXSkgPT4ge1xuICAgICAgICBpZiAocHJldlNsaWNlID09PSBFTVBUWSkge1xuICAgICAgICAgIHJldHVybiBzZWxlY3Rvcih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2xpY2UgPSBzZWxlY3Rvcih2YWx1ZSwgcHJldlNsaWNlKTtcbiAgICAgICAgcmV0dXJuIGVxdWFsaXR5Rm4ocHJldlNsaWNlLCBzbGljZSkgPyBwcmV2U2xpY2UgOiBzbGljZTtcbiAgICAgIH07XG4gICAgICBjb25zdCBkZXJpdmVkQXRvbSA9IGF0b20oKGdldCkgPT4ge1xuICAgICAgICBjb25zdCBwcmV2ID0gZ2V0KGRlcml2ZWRBdG9tKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBnZXQoYW5BdG9tKTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdFZhbHVlKFt2YWx1ZSwgcHJldl0pO1xuICAgICAgfSk7XG4gICAgICBkZXJpdmVkQXRvbS5pbml0ID0gRU1QVFk7XG4gICAgICByZXR1cm4gZGVyaXZlZEF0b207XG4gICAgfSxcbiAgICBhbkF0b20sXG4gICAgc2VsZWN0b3IsXG4gICAgZXF1YWxpdHlGblxuICApO1xufVxuXG5jb25zdCBmcm96ZW5BdG9tcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha1NldCgpO1xuY29uc3QgZGVlcEZyZWV6ZSA9ICh2YWx1ZSkgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcIm9iamVjdFwiIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIE9iamVjdC5mcmVlemUodmFsdWUpO1xuICBjb25zdCBwcm9wTmFtZXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh2YWx1ZSk7XG4gIGZvciAoY29uc3QgbmFtZSBvZiBwcm9wTmFtZXMpIHtcbiAgICBkZWVwRnJlZXplKHZhbHVlW25hbWVdKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59O1xuZnVuY3Rpb24gZnJlZXplQXRvbShhbkF0b20pIHtcbiAgaWYgKGZyb3plbkF0b21zLmhhcyhhbkF0b20pKSB7XG4gICAgcmV0dXJuIGFuQXRvbTtcbiAgfVxuICBmcm96ZW5BdG9tcy5hZGQoYW5BdG9tKTtcbiAgY29uc3Qgb3JpZ1JlYWQgPSBhbkF0b20ucmVhZDtcbiAgYW5BdG9tLnJlYWQgPSBmdW5jdGlvbihnZXQsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gZGVlcEZyZWV6ZShvcmlnUmVhZC5jYWxsKHRoaXMsIGdldCwgb3B0aW9ucykpO1xuICB9O1xuICBpZiAoXCJ3cml0ZVwiIGluIGFuQXRvbSkge1xuICAgIGNvbnN0IG9yaWdXcml0ZSA9IGFuQXRvbS53cml0ZTtcbiAgICBhbkF0b20ud3JpdGUgPSBmdW5jdGlvbihnZXQsIHNldCwgLi4uYXJncykge1xuICAgICAgcmV0dXJuIG9yaWdXcml0ZS5jYWxsKFxuICAgICAgICB0aGlzLFxuICAgICAgICBnZXQsXG4gICAgICAgICguLi5zZXRBcmdzKSA9PiB7XG4gICAgICAgICAgaWYgKHNldEFyZ3NbMF0gPT09IGFuQXRvbSkge1xuICAgICAgICAgICAgc2V0QXJnc1sxXSA9IGRlZXBGcmVlemUoc2V0QXJnc1sxXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBzZXQoLi4uc2V0QXJncyk7XG4gICAgICAgIH0sXG4gICAgICAgIC4uLmFyZ3NcbiAgICAgICk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gYW5BdG9tO1xufVxuZnVuY3Rpb24gZnJlZXplQXRvbUNyZWF0b3IoY3JlYXRlQXRvbSkge1xuICBpZiAoKGltcG9ydC5tZXRhLmVudiA/IGltcG9ydC5tZXRhLmVudi5NT0RFIDogdm9pZCAwKSAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBcIltERVBSRUNBVEVEXSBmcmVlemVBdG9tQ3JlYXRvciBpcyBkZXByZWNhdGVkLCBkZWZpbmUgaXQgb24gdXNlcnMgZW5kXCJcbiAgICApO1xuICB9XG4gIHJldHVybiAoLi4uYXJncykgPT4gZnJlZXplQXRvbShjcmVhdGVBdG9tKC4uLmFyZ3MpKTtcbn1cblxuY29uc3QgZ2V0Q2FjaGVkJDEgPSAoYywgbSwgaykgPT4gKG0uaGFzKGspID8gbSA6IG0uc2V0KGssIGMoKSkpLmdldChrKTtcbmNvbnN0IGNhY2hlMSQyID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG5jb25zdCBtZW1vMiQxID0gKGNyZWF0ZSwgZGVwMSwgZGVwMikgPT4ge1xuICBjb25zdCBjYWNoZTIgPSBnZXRDYWNoZWQkMSgoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKSwgY2FjaGUxJDIsIGRlcDEpO1xuICByZXR1cm4gZ2V0Q2FjaGVkJDEoY3JlYXRlLCBjYWNoZTIsIGRlcDIpO1xufTtcbmNvbnN0IGNhY2hlS2V5Rm9yRW1wdHlLZXlFeHRyYWN0b3IgPSB7fTtcbmNvbnN0IGlzV3JpdGFibGUgPSAoYXRvbTIpID0+ICEhYXRvbTIud3JpdGU7XG5jb25zdCBpc0Z1bmN0aW9uID0gKHgpID0+IHR5cGVvZiB4ID09PSBcImZ1bmN0aW9uXCI7XG5mdW5jdGlvbiBzcGxpdEF0b20oYXJyQXRvbSwga2V5RXh0cmFjdG9yKSB7XG4gIHJldHVybiBtZW1vMiQxKFxuICAgICgpID0+IHtcbiAgICAgIGNvbnN0IG1hcHBpbmdDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpO1xuICAgICAgY29uc3QgZ2V0TWFwcGluZyA9IChhcnIsIHByZXYpID0+IHtcbiAgICAgICAgbGV0IG1hcHBpbmcgPSBtYXBwaW5nQ2FjaGUuZ2V0KGFycik7XG4gICAgICAgIGlmIChtYXBwaW5nKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcHBpbmc7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcHJldk1hcHBpbmcgPSBwcmV2ICYmIG1hcHBpbmdDYWNoZS5nZXQocHJldik7XG4gICAgICAgIGNvbnN0IGF0b21MaXN0ID0gW107XG4gICAgICAgIGNvbnN0IGtleUxpc3QgPSBbXTtcbiAgICAgICAgYXJyLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgY29uc3Qga2V5ID0ga2V5RXh0cmFjdG9yID8ga2V5RXh0cmFjdG9yKGl0ZW0pIDogaW5kZXg7XG4gICAgICAgICAga2V5TGlzdFtpbmRleF0gPSBrZXk7XG4gICAgICAgICAgY29uc3QgY2FjaGVkQXRvbSA9IHByZXZNYXBwaW5nICYmIHByZXZNYXBwaW5nLmF0b21MaXN0W3ByZXZNYXBwaW5nLmtleUxpc3QuaW5kZXhPZihrZXkpXTtcbiAgICAgICAgICBpZiAoY2FjaGVkQXRvbSkge1xuICAgICAgICAgICAgYXRvbUxpc3RbaW5kZXhdID0gY2FjaGVkQXRvbTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgcmVhZCA9IChnZXQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHByZXYyID0gZ2V0KG1hcHBpbmdBdG9tKTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJBcnIgPSBnZXQoYXJyQXRvbSk7XG4gICAgICAgICAgICBjb25zdCBtYXBwaW5nMiA9IGdldE1hcHBpbmcoY3VyckFyciwgcHJldjIgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXYyLmFycik7XG4gICAgICAgICAgICBjb25zdCBpbmRleDIgPSBtYXBwaW5nMi5rZXlMaXN0LmluZGV4T2Yoa2V5KTtcbiAgICAgICAgICAgIGlmIChpbmRleDIgPCAwIHx8IGluZGV4MiA+PSBjdXJyQXJyLmxlbmd0aCkge1xuICAgICAgICAgICAgICBjb25zdCBwcmV2SXRlbSA9IGFycltnZXRNYXBwaW5nKGFycikua2V5TGlzdC5pbmRleE9mKGtleSldO1xuICAgICAgICAgICAgICBpZiAocHJldkl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJldkl0ZW07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic3BsaXRBdG9tOiBpbmRleCBvdXQgb2YgYm91bmRzIGZvciByZWFkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGN1cnJBcnJbaW5kZXgyXTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNvbnN0IHdyaXRlID0gKGdldCwgc2V0LCB1cGRhdGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHByZXYyID0gZ2V0KG1hcHBpbmdBdG9tKTtcbiAgICAgICAgICAgIGNvbnN0IGFycjIgPSBnZXQoYXJyQXRvbSk7XG4gICAgICAgICAgICBjb25zdCBtYXBwaW5nMiA9IGdldE1hcHBpbmcoYXJyMiwgcHJldjIgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXYyLmFycik7XG4gICAgICAgICAgICBjb25zdCBpbmRleDIgPSBtYXBwaW5nMi5rZXlMaXN0LmluZGV4T2Yoa2V5KTtcbiAgICAgICAgICAgIGlmIChpbmRleDIgPCAwIHx8IGluZGV4MiA+PSBhcnIyLmxlbmd0aCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzcGxpdEF0b206IGluZGV4IG91dCBvZiBib3VuZHMgZm9yIHdyaXRlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbmV4dEl0ZW0gPSBpc0Z1bmN0aW9uKHVwZGF0ZSkgPyB1cGRhdGUoYXJyMltpbmRleDJdKSA6IHVwZGF0ZTtcbiAgICAgICAgICAgIGlmICghT2JqZWN0LmlzKGFycjJbaW5kZXgyXSwgbmV4dEl0ZW0pKSB7XG4gICAgICAgICAgICAgIHNldChhcnJBdG9tLCBbXG4gICAgICAgICAgICAgICAgLi4uYXJyMi5zbGljZSgwLCBpbmRleDIpLFxuICAgICAgICAgICAgICAgIG5leHRJdGVtLFxuICAgICAgICAgICAgICAgIC4uLmFycjIuc2xpY2UoaW5kZXgyICsgMSlcbiAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBhdG9tTGlzdFtpbmRleF0gPSBpc1dyaXRhYmxlKGFyckF0b20pID8gYXRvbShyZWFkLCB3cml0ZSkgOiBhdG9tKHJlYWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHByZXZNYXBwaW5nICYmIHByZXZNYXBwaW5nLmtleUxpc3QubGVuZ3RoID09PSBrZXlMaXN0Lmxlbmd0aCAmJiBwcmV2TWFwcGluZy5rZXlMaXN0LmV2ZXJ5KCh4LCBpKSA9PiB4ID09PSBrZXlMaXN0W2ldKSkge1xuICAgICAgICAgIG1hcHBpbmcgPSBwcmV2TWFwcGluZztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtYXBwaW5nID0geyBhcnIsIGF0b21MaXN0LCBrZXlMaXN0IH07XG4gICAgICAgIH1cbiAgICAgICAgbWFwcGluZ0NhY2hlLnNldChhcnIsIG1hcHBpbmcpO1xuICAgICAgICByZXR1cm4gbWFwcGluZztcbiAgICAgIH07XG4gICAgICBjb25zdCBtYXBwaW5nQXRvbSA9IGF0b20oKGdldCkgPT4ge1xuICAgICAgICBjb25zdCBwcmV2ID0gZ2V0KG1hcHBpbmdBdG9tKTtcbiAgICAgICAgY29uc3QgYXJyID0gZ2V0KGFyckF0b20pO1xuICAgICAgICBjb25zdCBtYXBwaW5nID0gZ2V0TWFwcGluZyhhcnIsIHByZXYgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXYuYXJyKTtcbiAgICAgICAgcmV0dXJuIG1hcHBpbmc7XG4gICAgICB9KTtcbiAgICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICBtYXBwaW5nQXRvbS5kZWJ1Z1ByaXZhdGUgPSB0cnVlO1xuICAgICAgfVxuICAgICAgbWFwcGluZ0F0b20uaW5pdCA9IHZvaWQgMDtcbiAgICAgIGNvbnN0IHNwbGl0dGVkQXRvbSA9IGlzV3JpdGFibGUoYXJyQXRvbSkgPyBhdG9tKFxuICAgICAgICAoZ2V0KSA9PiBnZXQobWFwcGluZ0F0b20pLmF0b21MaXN0LFxuICAgICAgICAoZ2V0LCBzZXQsIGFjdGlvbikgPT4ge1xuICAgICAgICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IGdldChzcGxpdHRlZEF0b20pLmluZGV4T2YoYWN0aW9uLmF0b20pO1xuICAgICAgICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFyciA9IGdldChhcnJBdG9tKTtcbiAgICAgICAgICAgICAgICBzZXQoYXJyQXRvbSwgW1xuICAgICAgICAgICAgICAgICAgLi4uYXJyLnNsaWNlKDAsIGluZGV4KSxcbiAgICAgICAgICAgICAgICAgIC4uLmFyci5zbGljZShpbmRleCArIDEpXG4gICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwiaW5zZXJ0XCI6IHtcbiAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBhY3Rpb24uYmVmb3JlID8gZ2V0KHNwbGl0dGVkQXRvbSkuaW5kZXhPZihhY3Rpb24uYmVmb3JlKSA6IGdldChzcGxpdHRlZEF0b20pLmxlbmd0aDtcbiAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhcnIgPSBnZXQoYXJyQXRvbSk7XG4gICAgICAgICAgICAgICAgc2V0KGFyckF0b20sIFtcbiAgICAgICAgICAgICAgICAgIC4uLmFyci5zbGljZSgwLCBpbmRleCksXG4gICAgICAgICAgICAgICAgICBhY3Rpb24udmFsdWUsXG4gICAgICAgICAgICAgICAgICAuLi5hcnIuc2xpY2UoaW5kZXgpXG4gICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwibW92ZVwiOiB7XG4gICAgICAgICAgICAgIGNvbnN0IGluZGV4MSA9IGdldChzcGxpdHRlZEF0b20pLmluZGV4T2YoYWN0aW9uLmF0b20pO1xuICAgICAgICAgICAgICBjb25zdCBpbmRleDIgPSBhY3Rpb24uYmVmb3JlID8gZ2V0KHNwbGl0dGVkQXRvbSkuaW5kZXhPZihhY3Rpb24uYmVmb3JlKSA6IGdldChzcGxpdHRlZEF0b20pLmxlbmd0aDtcbiAgICAgICAgICAgICAgaWYgKGluZGV4MSA+PSAwICYmIGluZGV4MiA+PSAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXJyID0gZ2V0KGFyckF0b20pO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleDEgPCBpbmRleDIpIHtcbiAgICAgICAgICAgICAgICAgIHNldChhcnJBdG9tLCBbXG4gICAgICAgICAgICAgICAgICAgIC4uLmFyci5zbGljZSgwLCBpbmRleDEpLFxuICAgICAgICAgICAgICAgICAgICAuLi5hcnIuc2xpY2UoaW5kZXgxICsgMSwgaW5kZXgyKSxcbiAgICAgICAgICAgICAgICAgICAgYXJyW2luZGV4MV0sXG4gICAgICAgICAgICAgICAgICAgIC4uLmFyci5zbGljZShpbmRleDIpXG4gICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgc2V0KGFyckF0b20sIFtcbiAgICAgICAgICAgICAgICAgICAgLi4uYXJyLnNsaWNlKDAsIGluZGV4MiksXG4gICAgICAgICAgICAgICAgICAgIGFycltpbmRleDFdLFxuICAgICAgICAgICAgICAgICAgICAuLi5hcnIuc2xpY2UoaW5kZXgyLCBpbmRleDEpLFxuICAgICAgICAgICAgICAgICAgICAuLi5hcnIuc2xpY2UoaW5kZXgxICsgMSlcbiAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICkgOiBhdG9tKChnZXQpID0+IGdldChtYXBwaW5nQXRvbSkuYXRvbUxpc3QpO1xuICAgICAgcmV0dXJuIHNwbGl0dGVkQXRvbTtcbiAgICB9LFxuICAgIGFyckF0b20sXG4gICAga2V5RXh0cmFjdG9yIHx8IGNhY2hlS2V5Rm9yRW1wdHlLZXlFeHRyYWN0b3JcbiAgKTtcbn1cblxuZnVuY3Rpb24gYXRvbVdpdGhEZWZhdWx0KGdldERlZmF1bHQpIHtcbiAgY29uc3QgRU1QVFkgPSBTeW1ib2woKTtcbiAgY29uc3Qgb3ZlcndyaXR0ZW5BdG9tID0gYXRvbShFTVBUWSk7XG4gIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIG92ZXJ3cml0dGVuQXRvbS5kZWJ1Z1ByaXZhdGUgPSB0cnVlO1xuICB9XG4gIGNvbnN0IGFuQXRvbSA9IGF0b20oXG4gICAgKGdldCwgb3B0aW9ucykgPT4ge1xuICAgICAgY29uc3Qgb3ZlcndyaXR0ZW4gPSBnZXQob3ZlcndyaXR0ZW5BdG9tKTtcbiAgICAgIGlmIChvdmVyd3JpdHRlbiAhPT0gRU1QVFkpIHtcbiAgICAgICAgcmV0dXJuIG92ZXJ3cml0dGVuO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGdldERlZmF1bHQoZ2V0LCBvcHRpb25zKTtcbiAgICB9LFxuICAgIChnZXQsIHNldCwgdXBkYXRlKSA9PiB7XG4gICAgICBpZiAodXBkYXRlID09PSBSRVNFVCkge1xuICAgICAgICBzZXQob3ZlcndyaXR0ZW5BdG9tLCBFTVBUWSk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiB1cGRhdGUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBjb25zdCBwcmV2VmFsdWUgPSBnZXQoYW5BdG9tKTtcbiAgICAgICAgc2V0KG92ZXJ3cml0dGVuQXRvbSwgdXBkYXRlKHByZXZWYWx1ZSkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0KG92ZXJ3cml0dGVuQXRvbSwgdXBkYXRlKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIHJldHVybiBhbkF0b207XG59XG5cbmNvbnN0IGlzUHJvbWlzZUxpa2UkMyA9ICh4KSA9PiB0eXBlb2YgKHggPT0gbnVsbCA/IHZvaWQgMCA6IHgudGhlbikgPT09IFwiZnVuY3Rpb25cIjtcbmZ1bmN0aW9uIHdpdGhTdG9yYWdlVmFsaWRhdG9yKHZhbGlkYXRvcikge1xuICByZXR1cm4gKHVua25vd25TdG9yYWdlKSA9PiB7XG4gICAgY29uc3Qgc3RvcmFnZSA9IHtcbiAgICAgIC4uLnVua25vd25TdG9yYWdlLFxuICAgICAgZ2V0SXRlbTogKGtleSwgaW5pdGlhbFZhbHVlKSA9PiB7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRlID0gKHZhbHVlMikgPT4ge1xuICAgICAgICAgIGlmICghdmFsaWRhdG9yKHZhbHVlMikpIHtcbiAgICAgICAgICAgIHJldHVybiBpbml0aWFsVmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB2YWx1ZTI7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdW5rbm93blN0b3JhZ2UuZ2V0SXRlbShrZXksIGluaXRpYWxWYWx1ZSk7XG4gICAgICAgIGlmIChpc1Byb21pc2VMaWtlJDModmFsdWUpKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlLnRoZW4odmFsaWRhdGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZSh2YWx1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gc3RvcmFnZTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUpTT05TdG9yYWdlKGdldFN0cmluZ1N0b3JhZ2UgPSAoKSA9PiB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2U7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAoKGltcG9ydC5tZXRhLmVudiA/IGltcG9ydC5tZXRhLmVudi5NT0RFIDogdm9pZCAwKSAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgfVxufSwgb3B0aW9ucykge1xuICB2YXIgX2E7XG4gIGxldCBsYXN0U3RyO1xuICBsZXQgbGFzdFZhbHVlO1xuICBjb25zdCBzdG9yYWdlID0ge1xuICAgIGdldEl0ZW06IChrZXksIGluaXRpYWxWYWx1ZSkgPT4ge1xuICAgICAgdmFyIF9hMiwgX2I7XG4gICAgICBjb25zdCBwYXJzZSA9IChzdHIyKSA9PiB7XG4gICAgICAgIHN0cjIgPSBzdHIyIHx8IFwiXCI7XG4gICAgICAgIGlmIChsYXN0U3RyICE9PSBzdHIyKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxhc3RWYWx1ZSA9IEpTT04ucGFyc2Uoc3RyMiwgb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5yZXZpdmVyKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gaW5pdGlhbFZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsYXN0U3RyID0gc3RyMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGFzdFZhbHVlO1xuICAgICAgfTtcbiAgICAgIGNvbnN0IHN0ciA9IChfYiA9IChfYTIgPSBnZXRTdHJpbmdTdG9yYWdlKCkpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuZ2V0SXRlbShrZXkpKSAhPSBudWxsID8gX2IgOiBudWxsO1xuICAgICAgaWYgKGlzUHJvbWlzZUxpa2UkMyhzdHIpKSB7XG4gICAgICAgIHJldHVybiBzdHIudGhlbihwYXJzZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyc2Uoc3RyKTtcbiAgICB9LFxuICAgIHNldEl0ZW06IChrZXksIG5ld1ZhbHVlKSA9PiB7XG4gICAgICB2YXIgX2EyO1xuICAgICAgcmV0dXJuIChfYTIgPSBnZXRTdHJpbmdTdG9yYWdlKCkpID09IG51bGwgPyB2b2lkIDAgOiBfYTIuc2V0SXRlbShcbiAgICAgICAga2V5LFxuICAgICAgICBKU09OLnN0cmluZ2lmeShuZXdWYWx1ZSwgb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5yZXBsYWNlcilcbiAgICAgICk7XG4gICAgfSxcbiAgICByZW1vdmVJdGVtOiAoa2V5KSA9PiB7XG4gICAgICB2YXIgX2EyO1xuICAgICAgcmV0dXJuIChfYTIgPSBnZXRTdHJpbmdTdG9yYWdlKCkpID09IG51bGwgPyB2b2lkIDAgOiBfYTIucmVtb3ZlSXRlbShrZXkpO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgY3JlYXRlSGFuZGxlU3Vic2NyaWJlID0gKHN1YnNjcmliZXIyKSA9PiAoa2V5LCBjYWxsYmFjaywgaW5pdGlhbFZhbHVlKSA9PiBzdWJzY3JpYmVyMihrZXksICh2KSA9PiB7XG4gICAgbGV0IG5ld1ZhbHVlO1xuICAgIHRyeSB7XG4gICAgICBuZXdWYWx1ZSA9IEpTT04ucGFyc2UodiB8fCBcIlwiKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBuZXdWYWx1ZSA9IGluaXRpYWxWYWx1ZTtcbiAgICB9XG4gICAgY2FsbGJhY2sobmV3VmFsdWUpO1xuICB9KTtcbiAgbGV0IHN1YnNjcmliZXI7XG4gIHRyeSB7XG4gICAgc3Vic2NyaWJlciA9IChfYSA9IGdldFN0cmluZ1N0b3JhZ2UoKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnN1YnNjcmliZTtcbiAgfSBjYXRjaCAoZSkge1xuICB9XG4gIGlmICghc3Vic2NyaWJlciAmJiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciA9PT0gXCJmdW5jdGlvblwiICYmIHdpbmRvdy5TdG9yYWdlKSB7XG4gICAgc3Vic2NyaWJlciA9IChrZXksIGNhbGxiYWNrKSA9PiB7XG4gICAgICBpZiAoIShnZXRTdHJpbmdTdG9yYWdlKCkgaW5zdGFuY2VvZiB3aW5kb3cuU3RvcmFnZSkpIHtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN0b3JhZ2VFdmVudENhbGxiYWNrID0gKGUpID0+IHtcbiAgICAgICAgaWYgKGUuc3RvcmFnZUFyZWEgPT09IGdldFN0cmluZ1N0b3JhZ2UoKSAmJiBlLmtleSA9PT0ga2V5KSB7XG4gICAgICAgICAgY2FsbGJhY2soZS5uZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInN0b3JhZ2VcIiwgc3RvcmFnZUV2ZW50Q2FsbGJhY2spO1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIHN0b3JhZ2VFdmVudENhbGxiYWNrKTtcbiAgICAgIH07XG4gICAgfTtcbiAgfVxuICBpZiAoc3Vic2NyaWJlcikge1xuICAgIHN0b3JhZ2Uuc3Vic2NyaWJlID0gY3JlYXRlSGFuZGxlU3Vic2NyaWJlKHN1YnNjcmliZXIpO1xuICB9XG4gIHJldHVybiBzdG9yYWdlO1xufVxuY29uc3QgZGVmYXVsdFN0b3JhZ2UgPSBjcmVhdGVKU09OU3RvcmFnZSgpO1xuZnVuY3Rpb24gYXRvbVdpdGhTdG9yYWdlKGtleSwgaW5pdGlhbFZhbHVlLCBzdG9yYWdlID0gZGVmYXVsdFN0b3JhZ2UsIG9wdGlvbnMpIHtcbiAgY29uc3QgZ2V0T25Jbml0ID0gb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5nZXRPbkluaXQ7XG4gIGNvbnN0IGJhc2VBdG9tID0gYXRvbShcbiAgICBnZXRPbkluaXQgPyBzdG9yYWdlLmdldEl0ZW0oa2V5LCBpbml0aWFsVmFsdWUpIDogaW5pdGlhbFZhbHVlXG4gICk7XG4gIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIGJhc2VBdG9tLmRlYnVnUHJpdmF0ZSA9IHRydWU7XG4gIH1cbiAgYmFzZUF0b20ub25Nb3VudCA9IChzZXRBdG9tKSA9PiB7XG4gICAgc2V0QXRvbShzdG9yYWdlLmdldEl0ZW0oa2V5LCBpbml0aWFsVmFsdWUpKTtcbiAgICBsZXQgdW5zdWI7XG4gICAgaWYgKHN0b3JhZ2Uuc3Vic2NyaWJlKSB7XG4gICAgICB1bnN1YiA9IHN0b3JhZ2Uuc3Vic2NyaWJlKGtleSwgc2V0QXRvbSwgaW5pdGlhbFZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuc3ViO1xuICB9O1xuICBjb25zdCBhbkF0b20gPSBhdG9tKFxuICAgIChnZXQpID0+IGdldChiYXNlQXRvbSksXG4gICAgKGdldCwgc2V0LCB1cGRhdGUpID0+IHtcbiAgICAgIGNvbnN0IG5leHRWYWx1ZSA9IHR5cGVvZiB1cGRhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHVwZGF0ZShnZXQoYmFzZUF0b20pKSA6IHVwZGF0ZTtcbiAgICAgIGlmIChuZXh0VmFsdWUgPT09IFJFU0VUKSB7XG4gICAgICAgIHNldChiYXNlQXRvbSwgaW5pdGlhbFZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgfVxuICAgICAgaWYgKGlzUHJvbWlzZUxpa2UkMyhuZXh0VmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBuZXh0VmFsdWUudGhlbigocmVzb2x2ZWRWYWx1ZSkgPT4ge1xuICAgICAgICAgIHNldChiYXNlQXRvbSwgcmVzb2x2ZWRWYWx1ZSk7XG4gICAgICAgICAgcmV0dXJuIHN0b3JhZ2Uuc2V0SXRlbShrZXksIHJlc29sdmVkVmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHNldChiYXNlQXRvbSwgbmV4dFZhbHVlKTtcbiAgICAgIHJldHVybiBzdG9yYWdlLnNldEl0ZW0oa2V5LCBuZXh0VmFsdWUpO1xuICAgIH1cbiAgKTtcbiAgcmV0dXJuIGFuQXRvbTtcbn1cblxuY29uc3QgaXNQcm9taXNlTGlrZSQyID0gKHgpID0+IHR5cGVvZiAoeCA9PSBudWxsID8gdm9pZCAwIDogeC50aGVuKSA9PT0gXCJmdW5jdGlvblwiO1xuZnVuY3Rpb24gYXRvbVdpdGhPYnNlcnZhYmxlKGdldE9ic2VydmFibGUsIG9wdGlvbnMpIHtcbiAgY29uc3QgcmV0dXJuUmVzdWx0RGF0YSA9IChyZXN1bHQpID0+IHtcbiAgICBpZiAoXCJlXCIgaW4gcmVzdWx0KSB7XG4gICAgICB0aHJvdyByZXN1bHQuZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdC5kO1xuICB9O1xuICBjb25zdCBvYnNlcnZhYmxlUmVzdWx0QXRvbSA9IGF0b20oKGdldCkgPT4ge1xuICAgIHZhciBfYTtcbiAgICBsZXQgb2JzZXJ2YWJsZSA9IGdldE9ic2VydmFibGUoZ2V0KTtcbiAgICBjb25zdCBpdHNlbGYgPSAoX2EgPSBvYnNlcnZhYmxlW1N5bWJvbC5vYnNlcnZhYmxlXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwob2JzZXJ2YWJsZSk7XG4gICAgaWYgKGl0c2VsZikge1xuICAgICAgb2JzZXJ2YWJsZSA9IGl0c2VsZjtcbiAgICB9XG4gICAgbGV0IHJlc29sdmU7XG4gICAgY29uc3QgbWFrZVBlbmRpbmcgPSAoKSA9PiBuZXcgUHJvbWlzZSgocikgPT4ge1xuICAgICAgcmVzb2x2ZSA9IHI7XG4gICAgfSk7XG4gICAgY29uc3QgaW5pdGlhbFJlc3VsdCA9IG9wdGlvbnMgJiYgXCJpbml0aWFsVmFsdWVcIiBpbiBvcHRpb25zID8ge1xuICAgICAgZDogdHlwZW9mIG9wdGlvbnMuaW5pdGlhbFZhbHVlID09PSBcImZ1bmN0aW9uXCIgPyBvcHRpb25zLmluaXRpYWxWYWx1ZSgpIDogb3B0aW9ucy5pbml0aWFsVmFsdWVcbiAgICB9IDogbWFrZVBlbmRpbmcoKTtcbiAgICBsZXQgc2V0UmVzdWx0O1xuICAgIGxldCBsYXN0UmVzdWx0O1xuICAgIGNvbnN0IGxpc3RlbmVyID0gKHJlc3VsdCkgPT4ge1xuICAgICAgbGFzdFJlc3VsdCA9IHJlc3VsdDtcbiAgICAgIHJlc29sdmUgPT0gbnVsbCA/IHZvaWQgMCA6IHJlc29sdmUocmVzdWx0KTtcbiAgICAgIHNldFJlc3VsdCA9PSBudWxsID8gdm9pZCAwIDogc2V0UmVzdWx0KHJlc3VsdCk7XG4gICAgfTtcbiAgICBsZXQgc3Vic2NyaXB0aW9uO1xuICAgIGxldCB0aW1lcjtcbiAgICBjb25zdCBpc05vdE1vdW50ZWQgPSAoKSA9PiAhc2V0UmVzdWx0O1xuICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gKCkgPT4ge1xuICAgICAgaWYgKHN1YnNjcmlwdGlvbikge1xuICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uID0gdm9pZCAwO1xuICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc3RhcnQgPSAoKSA9PiB7XG4gICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgfVxuICAgICAgc3Vic2NyaXB0aW9uID0gb2JzZXJ2YWJsZS5zdWJzY3JpYmUoe1xuICAgICAgICBuZXh0OiAoZCkgPT4gbGlzdGVuZXIoeyBkIH0pLFxuICAgICAgICBlcnJvcjogKGUpID0+IGxpc3RlbmVyKHsgZSB9KSxcbiAgICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoaXNOb3RNb3VudGVkKCkgJiYgKG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMudW5zdGFibGVfdGltZW91dCkpIHtcbiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KHVuc3Vic2NyaWJlLCBvcHRpb25zLnVuc3RhYmxlX3RpbWVvdXQpO1xuICAgICAgfVxuICAgIH07XG4gICAgc3RhcnQoKTtcbiAgICBjb25zdCByZXN1bHRBdG9tID0gYXRvbShsYXN0UmVzdWx0IHx8IGluaXRpYWxSZXN1bHQpO1xuICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgcmVzdWx0QXRvbS5kZWJ1Z1ByaXZhdGUgPSB0cnVlO1xuICAgIH1cbiAgICByZXN1bHRBdG9tLm9uTW91bnQgPSAodXBkYXRlKSA9PiB7XG4gICAgICBzZXRSZXN1bHQgPSB1cGRhdGU7XG4gICAgICBpZiAobGFzdFJlc3VsdCkge1xuICAgICAgICB1cGRhdGUobGFzdFJlc3VsdCk7XG4gICAgICB9XG4gICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGFydCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgc2V0UmVzdWx0ID0gdm9pZCAwO1xuICAgICAgICBpZiAob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy51bnN0YWJsZV90aW1lb3V0KSB7XG4gICAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KHVuc3Vic2NyaWJlLCBvcHRpb25zLnVuc3RhYmxlX3RpbWVvdXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfTtcbiAgICByZXR1cm4gW3Jlc3VsdEF0b20sIG9ic2VydmFibGUsIG1ha2VQZW5kaW5nLCBzdGFydCwgaXNOb3RNb3VudGVkXTtcbiAgfSk7XG4gIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIG9ic2VydmFibGVSZXN1bHRBdG9tLmRlYnVnUHJpdmF0ZSA9IHRydWU7XG4gIH1cbiAgY29uc3Qgb2JzZXJ2YWJsZUF0b20gPSBhdG9tKFxuICAgIChnZXQpID0+IHtcbiAgICAgIGNvbnN0IFtyZXN1bHRBdG9tXSA9IGdldChvYnNlcnZhYmxlUmVzdWx0QXRvbSk7XG4gICAgICBjb25zdCByZXN1bHQgPSBnZXQocmVzdWx0QXRvbSk7XG4gICAgICBpZiAoaXNQcm9taXNlTGlrZSQyKHJlc3VsdCkpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC50aGVuKHJldHVyblJlc3VsdERhdGEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJldHVyblJlc3VsdERhdGEocmVzdWx0KTtcbiAgICB9LFxuICAgIChnZXQsIHNldCwgZGF0YSkgPT4ge1xuICAgICAgY29uc3QgW3Jlc3VsdEF0b20sIG9ic2VydmFibGUsIG1ha2VQZW5kaW5nLCBzdGFydCwgaXNOb3RNb3VudGVkXSA9IGdldChvYnNlcnZhYmxlUmVzdWx0QXRvbSk7XG4gICAgICBpZiAoXCJuZXh0XCIgaW4gb2JzZXJ2YWJsZSkge1xuICAgICAgICBpZiAoaXNOb3RNb3VudGVkKCkpIHtcbiAgICAgICAgICBzZXQocmVzdWx0QXRvbSwgbWFrZVBlbmRpbmcoKSk7XG4gICAgICAgICAgc3RhcnQoKTtcbiAgICAgICAgfVxuICAgICAgICBvYnNlcnZhYmxlLm5leHQoZGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJvYnNlcnZhYmxlIGlzIG5vdCBzdWJqZWN0XCIpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgcmV0dXJuIG9ic2VydmFibGVBdG9tO1xufVxuXG5jb25zdCBjYWNoZTEkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpO1xuY29uc3QgbWVtbzEgPSAoY3JlYXRlLCBkZXAxKSA9PiAoY2FjaGUxJDEuaGFzKGRlcDEpID8gY2FjaGUxJDEgOiBjYWNoZTEkMS5zZXQoZGVwMSwgY3JlYXRlKCkpKS5nZXQoZGVwMSk7XG5jb25zdCBpc1Byb21pc2VMaWtlJDEgPSAocCkgPT4gdHlwZW9mIChwID09IG51bGwgPyB2b2lkIDAgOiBwLnRoZW4pID09PSBcImZ1bmN0aW9uXCI7XG5jb25zdCBMT0FESU5HID0geyBzdGF0ZTogXCJsb2FkaW5nXCIgfTtcbmZ1bmN0aW9uIGxvYWRhYmxlKGFuQXRvbSkge1xuICByZXR1cm4gbWVtbzEoKCkgPT4ge1xuICAgIGNvbnN0IGxvYWRhYmxlQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgICBjb25zdCByZWZyZXNoQXRvbSA9IGF0b20oMCk7XG4gICAgaWYgKChpbXBvcnQubWV0YS5lbnYgPyBpbXBvcnQubWV0YS5lbnYuTU9ERSA6IHZvaWQgMCkgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICByZWZyZXNoQXRvbS5kZWJ1Z1ByaXZhdGUgPSB0cnVlO1xuICAgIH1cbiAgICBjb25zdCBkZXJpdmVkQXRvbSA9IGF0b20oXG4gICAgICAoZ2V0LCB7IHNldFNlbGYgfSkgPT4ge1xuICAgICAgICBnZXQocmVmcmVzaEF0b20pO1xuICAgICAgICBsZXQgdmFsdWU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdmFsdWUgPSBnZXQoYW5BdG9tKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4geyBzdGF0ZTogXCJoYXNFcnJvclwiLCBlcnJvciB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNQcm9taXNlTGlrZSQxKHZhbHVlKSkge1xuICAgICAgICAgIHJldHVybiB7IHN0YXRlOiBcImhhc0RhdGFcIiwgZGF0YTogdmFsdWUgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwcm9taXNlID0gdmFsdWU7XG4gICAgICAgIGNvbnN0IGNhY2hlZDEgPSBsb2FkYWJsZUNhY2hlLmdldChwcm9taXNlKTtcbiAgICAgICAgaWYgKGNhY2hlZDEpIHtcbiAgICAgICAgICByZXR1cm4gY2FjaGVkMTtcbiAgICAgICAgfVxuICAgICAgICBwcm9taXNlLnRoZW4oXG4gICAgICAgICAgKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGxvYWRhYmxlQ2FjaGUuc2V0KHByb21pc2UsIHsgc3RhdGU6IFwiaGFzRGF0YVwiLCBkYXRhIH0pO1xuICAgICAgICAgICAgc2V0U2VsZigpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBsb2FkYWJsZUNhY2hlLnNldChwcm9taXNlLCB7IHN0YXRlOiBcImhhc0Vycm9yXCIsIGVycm9yIH0pO1xuICAgICAgICAgICAgc2V0U2VsZigpO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgY2FjaGVkMiA9IGxvYWRhYmxlQ2FjaGUuZ2V0KHByb21pc2UpO1xuICAgICAgICBpZiAoY2FjaGVkMikge1xuICAgICAgICAgIHJldHVybiBjYWNoZWQyO1xuICAgICAgICB9XG4gICAgICAgIGxvYWRhYmxlQ2FjaGUuc2V0KHByb21pc2UsIExPQURJTkcpO1xuICAgICAgICByZXR1cm4gTE9BRElORztcbiAgICAgIH0sXG4gICAgICAoX2dldCwgc2V0KSA9PiB7XG4gICAgICAgIHNldChyZWZyZXNoQXRvbSwgKGMpID0+IGMgKyAxKTtcbiAgICAgIH1cbiAgICApO1xuICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgZGVyaXZlZEF0b20uZGVidWdQcml2YXRlID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGF0b20oKGdldCkgPT4gZ2V0KGRlcml2ZWRBdG9tKSk7XG4gIH0sIGFuQXRvbSk7XG59XG5cbmNvbnN0IGdldENhY2hlZCA9IChjLCBtLCBrKSA9PiAobS5oYXMoaykgPyBtIDogbS5zZXQoaywgYygpKSkuZ2V0KGspO1xuY29uc3QgY2FjaGUxID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG5jb25zdCBtZW1vMiA9IChjcmVhdGUsIGRlcDEsIGRlcDIpID0+IHtcbiAgY29uc3QgY2FjaGUyID0gZ2V0Q2FjaGVkKCgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpLCBjYWNoZTEsIGRlcDEpO1xuICByZXR1cm4gZ2V0Q2FjaGVkKGNyZWF0ZSwgY2FjaGUyLCBkZXAyKTtcbn07XG5jb25zdCBpc1Byb21pc2VMaWtlID0gKHApID0+IHR5cGVvZiAocCA9PSBudWxsID8gdm9pZCAwIDogcC50aGVuKSA9PT0gXCJmdW5jdGlvblwiO1xuY29uc3QgZGVmYXVsdEZhbGxiYWNrID0gKCkgPT4gdm9pZCAwO1xuZnVuY3Rpb24gdW53cmFwKGFuQXRvbSwgZmFsbGJhY2sgPSBkZWZhdWx0RmFsbGJhY2spIHtcbiAgcmV0dXJuIG1lbW8yKFxuICAgICgpID0+IHtcbiAgICAgIGNvbnN0IHByb21pc2VFcnJvckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG4gICAgICBjb25zdCBwcm9taXNlUmVzdWx0Q2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgICAgIGNvbnN0IHJlZnJlc2hBdG9tID0gYXRvbSgwKTtcbiAgICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICByZWZyZXNoQXRvbS5kZWJ1Z1ByaXZhdGUgPSB0cnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgcHJvbWlzZUFuZFZhbHVlQXRvbSA9IGF0b20oXG4gICAgICAgIChnZXQsIHsgc2V0U2VsZiB9KSA9PiB7XG4gICAgICAgICAgZ2V0KHJlZnJlc2hBdG9tKTtcbiAgICAgICAgICBjb25zdCBwcmV2ID0gZ2V0KHByb21pc2VBbmRWYWx1ZUF0b20pO1xuICAgICAgICAgIGNvbnN0IHByb21pc2UgPSBnZXQoYW5BdG9tKTtcbiAgICAgICAgICBpZiAoIWlzUHJvbWlzZUxpa2UocHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHY6IHByb21pc2UgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHByb21pc2UgIT09IChwcmV2ID09IG51bGwgPyB2b2lkIDAgOiBwcmV2LnApKSB7XG4gICAgICAgICAgICBwcm9taXNlLnRoZW4oXG4gICAgICAgICAgICAgICh2KSA9PiB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZVJlc3VsdENhY2hlLnNldChwcm9taXNlLCB2KTtcbiAgICAgICAgICAgICAgICBzZXRTZWxmKCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZUVycm9yQ2FjaGUuc2V0KHByb21pc2UsIGUpO1xuICAgICAgICAgICAgICAgIHNldFNlbGYoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHByb21pc2VFcnJvckNhY2hlLmhhcyhwcm9taXNlKSkge1xuICAgICAgICAgICAgdGhyb3cgcHJvbWlzZUVycm9yQ2FjaGUuZ2V0KHByb21pc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocHJvbWlzZVJlc3VsdENhY2hlLmhhcyhwcm9taXNlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgcDogcHJvbWlzZSxcbiAgICAgICAgICAgICAgdjogcHJvbWlzZVJlc3VsdENhY2hlLmdldChwcm9taXNlKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHByZXYgJiYgXCJ2XCIgaW4gcHJldikge1xuICAgICAgICAgICAgcmV0dXJuIHsgcDogcHJvbWlzZSwgZjogZmFsbGJhY2socHJldi52KSwgdjogcHJldi52IH07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB7IHA6IHByb21pc2UsIGY6IGZhbGxiYWNrKCkgfTtcbiAgICAgICAgfSxcbiAgICAgICAgKF9nZXQsIHNldCkgPT4ge1xuICAgICAgICAgIHNldChyZWZyZXNoQXRvbSwgKGMpID0+IGMgKyAxKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHByb21pc2VBbmRWYWx1ZUF0b20uaW5pdCA9IHZvaWQgMDtcbiAgICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICBwcm9taXNlQW5kVmFsdWVBdG9tLmRlYnVnUHJpdmF0ZSA9IHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gYXRvbShcbiAgICAgICAgKGdldCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHN0YXRlID0gZ2V0KHByb21pc2VBbmRWYWx1ZUF0b20pO1xuICAgICAgICAgIGlmIChcImZcIiBpbiBzdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHN0YXRlLmY7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBzdGF0ZS52O1xuICAgICAgICB9LFxuICAgICAgICAoX2dldCwgc2V0LCAuLi5hcmdzKSA9PiBzZXQoYW5BdG9tLCAuLi5hcmdzKVxuICAgICAgKTtcbiAgICB9LFxuICAgIGFuQXRvbSxcbiAgICBmYWxsYmFja1xuICApO1xufVxuXG5mdW5jdGlvbiBhdG9tV2l0aFJlZnJlc2gocmVhZCwgd3JpdGUpIHtcbiAgY29uc3QgcmVmcmVzaEF0b20gPSBhdG9tKDApO1xuICBpZiAoKGltcG9ydC5tZXRhLmVudiA/IGltcG9ydC5tZXRhLmVudi5NT0RFIDogdm9pZCAwKSAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICByZWZyZXNoQXRvbS5kZWJ1Z1ByaXZhdGUgPSB0cnVlO1xuICB9XG4gIHJldHVybiBhdG9tKFxuICAgIChnZXQsIG9wdGlvbnMpID0+IHtcbiAgICAgIGdldChyZWZyZXNoQXRvbSk7XG4gICAgICByZXR1cm4gcmVhZChnZXQsIG9wdGlvbnMpO1xuICAgIH0sXG4gICAgKGdldCwgc2V0LCAuLi5hcmdzKSA9PiB7XG4gICAgICBpZiAoYXJncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2V0KHJlZnJlc2hBdG9tLCAoYykgPT4gYyArIDEpO1xuICAgICAgfSBlbHNlIGlmICh3cml0ZSkge1xuICAgICAgICByZXR1cm4gd3JpdGUoZ2V0LCBzZXQsIC4uLmFyZ3MpO1xuICAgICAgfSBlbHNlIGlmICgoaW1wb3J0Lm1ldGEuZW52ID8gaW1wb3J0Lm1ldGEuZW52Lk1PREUgOiB2b2lkIDApICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJyZWZyZXNoIG11c3QgYmUgY2FsbGVkIHdpdGhvdXQgYXJndW1lbnRzXCIpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbn1cblxuZnVuY3Rpb24gYXRvbVdpdGhMYXp5KG1ha2VJbml0aWFsKSB7XG4gIGNvbnN0IGEgPSBhdG9tKHZvaWQgMCk7XG4gIGRlbGV0ZSBhLmluaXQ7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBcImluaXRcIiwge1xuICAgIGdldCgpIHtcbiAgICAgIHJldHVybiBtYWtlSW5pdGlhbCgpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBhO1xufVxuXG5leHBvcnQgeyBSRVNFVCwgYXRvbUZhbWlseSwgYXRvbVdpdGhEZWZhdWx0LCBhdG9tV2l0aExhenksIGF0b21XaXRoT2JzZXJ2YWJsZSwgYXRvbVdpdGhSZWR1Y2VyLCBhdG9tV2l0aFJlZnJlc2gsIGF0b21XaXRoUmVzZXQsIGF0b21XaXRoU3RvcmFnZSwgY3JlYXRlSlNPTlN0b3JhZ2UsIGZyZWV6ZUF0b20sIGZyZWV6ZUF0b21DcmVhdG9yLCBsb2FkYWJsZSwgc2VsZWN0QXRvbSwgc3BsaXRBdG9tLCB3aXRoU3RvcmFnZVZhbGlkYXRvciBhcyB1bnN0YWJsZV93aXRoU3RvcmFnZVZhbGlkYXRvciwgdW53cmFwIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla/utils.mjs\n");

/***/ })

};
;